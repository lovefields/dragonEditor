!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("dragonEditor",[],t):"object"==typeof exports?exports.dragonEditor=t():e.dragonEditor=t()}(window,(function(){return function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=3)}([function(e,t,a){"use strict";function s(e){return document.querySelector(e)}function n(e){let t=document.querySelectorAll(e);return t.length<1?null:t}function o(e,t){if("HTMLBodyElement"!==e.constructor.name&&"HTMLHtmlElement"!==e.constructor.name){return!0===e.classList.contains(t)?e:o(e.parentElement,t)}return null}function i(e,t,a="single"){let o;return o="single"===a?s("string"!=typeof e?t:e):n("string"!=typeof e?t:e),o}function l(e){let t,a=e.constructor.name;if("HTMLBodyElement"!==a){return t="Text"===a?e.parentElement:e,"true"===t.getAttribute("contenteditable")?t:this.findContenteditable(t.parentElement)}return!1}a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return k})),a.d(t,"c",(function(){return S})),a.d(t,"b",(function(){return _}));var s=a(0);function n(e,t){let a=null===Object(s.c)(e,"item")?Object(s.c)(e,"btn"):Object(s.c)(e,"item");t.forEach((function(e){e.classList.remove("lastset")})),a.classList.add("lastset")}function o(e,t){if(storage.classList.indexOf(t)>=0){let a=e.match(storage.classReg[t]);return""!==e&&null!==a?a[0]:""}console.warn(`You send wrong type name : [${t}]`)}function i(e){let t,a=e.constructor.name;if("HTMLBodyElement"!==a){return t="Text"===a?e.parentElement:e,"true"===t.getAttribute("contenteditable")?t:i(t.parentElement)}return null}function l(e){!0===e.classList.contains("lastset")&&e.classList.remove("lastset")}function r(e,t){let a=storage.popOptions.querySelectorAll(".col"),s=new RegExp(t,"i"),n=0;storage.popOptions.classList.add("act"),storage.popOptions.querySelector(".pop").classList.remove("act"),null!==a&&a.forEach((function(e){let t=e.dataset.group;switch(!0){case"all"===t:case!0===s.test(t):e.classList.add("act"),n+=e.getBoundingClientRect().width;break;case!1===s.test(t):e.classList.remove("act")}}));let o=storage.popOptions.getBoundingClientRect(),i=Math.floor(e.top-o.height),l=Math.floor((storage.windowWidth-storage.popOptions.getBoundingClientRect().width)/2);storage.windowWidth>storage.changePint?storage.popOptions.style.cssText="transform:translate("+l+"px, "+i+"px)":storage.popOptions.querySelector(".scroll").style.width=n+"px"}function c(e){let t=Object(s.c)(e,"item");t=null===t?Object(s.c)(e,"btn"):t;let a=storage.activeElement;if(null!==t){let e=t.dataset.type,s=a.constructor.name,n=t.classList.value,i=a.classList.value;switch(storage.urlInput.value="",e){case"text":let e=o(n,"color"),a=o(n,"size");storage.btnColorSelect.dataset.class=""!==e?e:"default",storage.fontSizeSelect.value=""!==a?a:"default";break;case"image":let s=t.querySelector(".img").getAttribute("width");storage.widthInput.value=s;break;case"youtube":if(!1===t.classList.contains("btn")){let e=t.querySelector(".video").getAttribute("src");storage.urlInput.value=e}else storage.urlInput.value="";break;case"codepen":if(!1===t.classList.contains("btn")){let e=t.querySelector(".iframe"),a=e.getAttribute("src"),s=e.getAttribute("height");storage.urlInput.value=a,storage.heightInput.value=s}else storage.urlInput.value="",storage.heightInput.value="";break;case"list_o":let i=t.getAttribute("type");storage.listTypeSelect.value=i;break;case"codeblock":let l=t.dataset.theme,r=t.dataset.lang,c=o(n,"size");storage.fontSizeSelect.value=""!==c?c:"default",storage.themeSelect.value=l,storage.languageSelect.value=r}switch(!0){case"HTMLAnchorElement"===s:let e=a.getAttribute("href");storage.urlInput.value=e;break;case("HTMLTableCellElement"===s||"HTMLTableCaptionElement"===s)&&"table"===t.dataset.type:if("HTMLTableCellElement"===s){let e=parseInt(a.dataset.x)+1,s=t.querySelector("col:nth-child("+e+")").classList.value;storage.colSizeSelect.value=o(s,"size")}let n=o(i,"color"),l=o(i,"size");storage.btnColorSelect.dataset.class=""!==n?n:"default",storage.fontSizeSelect.value=""!==l?l:"default";break;case"HTMLSpanElement"===s||"HTMLElement"===s:let r=o(i,"color");storage.btnColorSelect.dataset.class=""!==r?r:"default";break;case"HTMLLIElement"===s:let c=o(i,"color"),d=o(i,"size");storage.btnColorSelect.dataset.class=""!==c?c:"default",storage.fontSizeSelect.value=""!==d?d:"default"}}}function d(e,t){"click"===t&&(storage.activeElement=e);let a=function(e){let t,a=null;if("HTMLBodyElement"!==document.activeElement.constructor.name)switch(storage.activeElement.constructor.name){case"HTMLSpanElement":case"HTMLElement":case"HTMLAnchorElement":t=storage.activeElement;break;case"Text":t=Object(s.c)(storage.activeElement.parentElement,"item");break;default:t=Object(s.c)(storage.activeElement,"item")}else t=Object(s.c)(e,"item"),a=null===t?Object(s.c)(e,"btn"):t;return null===t?a:t}(e),o=window.getSelection().baseOffset,i=window.getSelection().extentOffset;if(null!==a){let l=a.getBoundingClientRect(),c=a.dataset.type,d=Object(s.e)(storage.contentAreaName+" > *"),g=a.classList.contains("btn");switch(!0){case"TH"===e.tagName||"TD"===e.tagName:c="table",l=e.getBoundingClientRect();break;case"CODE"===a.tagName&&"PRE"===a.parentElement.tagName:c="codeblock";break;case"HTMLElement"===a.constructor.name&&a.classList.contains("wordblock"):c="wordblock";break;case"HTMLAnchorElement"===a.constructor.name:c="link";break;case!0===g&&"click"===t:if(void 0!==a.dataset.value){let e=a.dataset.value;"image"===e?(storage.fileInput.dataset.type="image",storage.fileInput.setAttribute("accept","image/*"),storage.fileInput.click()):c=e}break;case window.getSelection().focusNode!==window.getSelection().baseNode:c="text";break;case o!==i:"BLOCKQUOTE"!==a.tagName&&(storage.focusNode=window.getSelection().focusNode,storage.baseNode=window.getSelection().baseNode,storage.startTextCursor=o,storage.endTextCursor=i,c="word");break;case void 0===c:c="all";break;default:c=c}if("click"===t)n(a,d),r(l,c);else if("mouseover"===t)if("youtube"!==c&&"codepen"!==c||!1!==g){if(!0===g){"image"===a.dataset.value?r(l,c):storage.popOptions.classList.remove("act")}}else n(a,d),r(l,c)}}function g(e,t="",a="afterend"){l(e);let s=storage.HTMLTextBlock.replace("[content]",t);e.insertAdjacentHTML(a,s),setTimeout(()=>{e.nextElementSibling.focus()},10)}function u(e,t){let a=window.getSelection(),s=document.createRange();s.setStart(e,t),s.collapse(!0),a.removeAllRanges(),a.addRange(s)}function p(e,t,a,s){l(e);let n=storage.HTMLBtn.replace(/\[icon_id\]/g,t).replace(/\[icon_size\]/g,storage.iconSize).replace(/\[type\]/g,a).replace(/\[text\]/g,s);e.insertAdjacentHTML("afterend",n)}function m(e,t,a=null,s=""){let n;l(e),n="ol"===t?"list_o":"list_u";let o=null===a?"":'type="'+a+'"',i=storage.HTMLChildList.replace(/\[content\]/g,s),r=storage.HTMLList.replace(/\[tag\]/g,t).replace("[dataType]",n).replace("[type]",o).replace("[child]",i);e.insertAdjacentHTML("afterend",r),e.nextElementSibling.children[0].focus()}function b(e){let t=storage.activeElement,a=t.tagName,s=t.innerHTML;if(a!==e.toUpperCase()){let a=t.dataset.x,n=t.dataset.y;t.insertAdjacentHTML("afterend",`<${e} contenteditable="true" data-x="${a}" data-y="${n}">${s}</${e}>`),storage.activeElement=t.nextElementSibling,t.nextElementSibling.focus(),t.remove()}}function h(e,t,a="afterend"){l(e),""===t.img&&(t.img=storage.defaultLinkBoxImage);let s=storage.HTMLLinkBox.replace("[url]",t.url).replace("[imgSrc]",t.img).replace("[title]",t.title).replace("[description]",t.description).replace("[domain]",t.domain);"innerHTML"===a?e.innerHTML=s:e.insertAdjacentHTML(a,s)}function f(e,t,a="afterend"){let s,n;if(l(e),n=100/t.width*t.height>100?300:t.width,n>storage.maxImageWidth&&(n=storage.maxImageWidth),!0===storage.useWebp)if(s=storage.HTMLImageType01.replace("[src]",`${t.src}.${t.format}`).replace("[alt]",t.alt).replace("[width]",n),!0===t.webp){let e=storage.HTMLImageSource.replace("[webp]",t.src+".webp");s=s.replace("[source]",e)}else s=s.replace("[source]","");else s=storage.HTMLImageType02.replace("[src]",`${t.src}.${t.format}`).replace("[alt]",t.alt).replace("[width]",n);e.insertAdjacentHTML(a,s)}function y(e,t={},a="form"){let s=new FormData;if("json"===a){for(let e in t.body)s.append(e,t.body[e]);t.body=s}return fetch(e,t).then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok.")})}async function L(e){let t=e.target,a=Object(s.c)(t,"item"),n=function(e){if(!1===e)return;let t=e.items;if(void 0===t)return;let a,s,n=t.length;for(let e=0;e<n;e+=1){if(0===t[e].type.indexOf("image")){a="image",s=t[e].getAsFile();break}a="text"}"text"===a&&(s=e.getData("text"));return{type:a,value:s}}(e.clipboardData),o=a.dataset.type;if("text"===n.type)if("codeblock"===o){let e=n.value.trim(),t=a.querySelector("code");if(""!==t.textContent){!0===confirm(storage.messageRePasteCode)&&(t.textContent=e)}else t.textContent=e}else{let e=n.value.trim().split("\n"),a=e.length,s=new RegExp(" ?\\d\\.","i"),o=new RegExp(" ?\\- ?","i"),i="text",l="";if(a>1)if((s.test(n)||o.test(n))&&(i="html"),"html"===i){let t,a=!1;e.forEach((function(e){s.test(e)?!1===a?(a=!0,t="ol",l+='<ol type="1" class="item item_list lastset" data-type="list_o">',l+=storage.HTMLChildList.replace("[content]",e.replace(s,"").trim())):l+=storage.HTMLChildList.replace("[content]",e.replace(s,"").trim()):o.test(e)?!1===a?(a=!0,t="ul",l+='<ul class="item item_list lastset" data-type="list_u">',l+=storage.HTMLChildList.replace("[content]",e.replace(o,"").trim())):l+=storage.HTMLChildList.replace("[content]",e.replace(o,"").trim()):!0===a?(a=!1,l+="ol"===t?"</ol>":"</ul>",l+=storage.HTMLTextBlock.replace("[content]",e)):l+=storage.HTMLTextBlock.replace("[content]",e)}))}else l=e.join("");else l=e[0];if("html"===i)t.insertAdjacentHTML("afterend",l),window.scrollTo(0,window.scrollY+1);else{if(""===t.textContent){let e=l.length;t.textContent=l,u(t.childNodes[0],e)}else alert("Sorry we are not ready for this.")}}else if("image"===n.type){let e=storage.contentArea,t=n.value,a=new FormData,o="image",i=e.dataset.idx,l=e.dataset.tempIdx;a.append("request_type","upload"),a.append("file_type",o),a.append("file",t),a.append("article_idx",i),a.append("temp_idx",l);let r=await y(storage.mediaUploadURL,{method:"POST",body:a});if(!0===r.result){let e=null===Object(s.d)(".lastset")?Object(s.d)(storage.contentAreaName+" > *:nth-last-child(1)"):Object(s.d)(".lastset"),t=r.list,a="";for(let s of t){let t="y"===s.webp;a+=storage.HTMLMediaRow.replace(/\[idx\]/g,s.idx).replace("[webp]",t).replace("[height]",s.height).replace("[width]",s.width).replace("[src]",`${s.src}${s.name}.${s.format}`).replace("[alt]",s.alt).replace("[name]",s.alt),f(e,{idx:s.idx,src:`${s.src}${s.name}`,webp:t,format:s.format,alt:s.alt,width:s.width,height:s.height})}e.classList.contains("btn")&&e.remove(),storage.mediaList.insertAdjacentHTML("beforeend",a),storage.popMedia.classList.add("act")}else alert(r.message)}}function v(){let e=storage.urlInput.value;if(!0===storage.urlReg.test(e)){let t=storage.focusNode===storage.baseNode,a=storage.activeElement.tagName;!0===t?"A"!==a&&w("link",e):alert(storage.messageWrongNode)}else alert(storage.messageWrongURL)}function x(e,t,a){if(storage.focusNode===storage.baseNode){let s=storage.activeElement,n=s.constructor.name,o=i(s);if("HTMLAnchorElement"===n||"HTMLSpanElement"===n||"HTMLElement"===n){let n=s.classList,i=n.length,l=s.textContent;s.tagName===t?i>0?(s.insertAdjacentHTML("afterend",`<span class="${n.value}">${l}</span>`),storage.activeElement=s.nextElementSibling,s.remove()):(s.insertAdjacentText("afterend",l),s.remove(),o.innerHTML=o.innerHTML,storage.activeElement=storage.wrap):"SPAN"===s.tagName?i>0?(s.insertAdjacentHTML("afterend",`<${e} class="${n.value}">${l}</${e}>`),storage.activeElement=s.nextElementSibling,s.remove()):(s.insertAdjacentHTML("afterend",`<${e}>${l}</${e}>`),storage.activeElement=s.nextElementSibling,s.remove()):!0===s.classList.contains(a)?s.classList.remove(a):s.classList.add(a)}else window.getSelection().focusOffset!==window.getSelection().baseOffset?w(a):!0===s.classList.contains(a)?s.classList.remove(a):s.classList.add(a)}else alert(storage.messageWrongNode)}function w(e,t=null,a=null){let s=storage.focusNode.textContent,n=i(storage.focusNode);n.innerHTML=n.innerHTML;let o,l,r,c,d=n.childNodes,g=d.length,u="";for(let e=0;e<g;e+=1)if("Text"===d[e].constructor.name&&s===d[e].textContent){o=e;break}switch(storage.startTextCursor>storage.endTextCursor?(l=storage.endTextCursor,r=storage.startTextCursor):(l=storage.startTextCursor,r=storage.endTextCursor),e){case"link":c=`${s.substring(0,l)}<a href="${t}" rel="nofollow">${s.substring(l,r)}</a>${s.substring(r)}`;break;case"bold":c=`${s.substring(0,l)}<b>${s.substring(l,r)}</b>${s.substring(r)}`;break;case"italic":c=`${s.substring(0,l)}<i>${s.substring(l,r)}</i>${s.substring(r)}`;break;case"underline":c=`${s.substring(0,l)}<u>${s.substring(l,r)}</u>${s.substring(r)}`;break;case"strike":c=`${s.substring(0,l)}<s>${s.substring(l,r)}</s>${s.substring(r)}`;break;case"wordblock":c=`${s.substring(0,l)}<code class="wordblock">${s.substring(l,r)}</code>${s.substring(r)}`;break;case"color":c=`${s.substring(0,l)}<span class="${a}">${s.substring(l,r)}</span>${s.substring(r)}`}for(let e=0;e<g;e+=1)e!==o?"Text"===d[e].constructor.name?u+=d[e].textContent:u+=d[e].outerHTML:u+=c;n.innerHTML=u}function k(){let e,t,a;window.onbeforeunload=function(e){if(!0===storage.edited)return e.returnValue},window.addEventListener("resize",(function(){clearTimeout(e),e=setTimeout(()=>{storage.windowWidth=window.innerWidth,storage.windowHeight=window.innerHeight,storage.popOptions.removeAttribute("style"),storage.popOptions.classList.remove("act")},250)})),document.addEventListener("contextmenu",(function(e){e.preventDefault()})),document.addEventListener("mouseup",(function(e){!function(e){if("object"==typeof e){let t=e.target;if(0===e.button){let e=Object(s.c)(t,"pop"),a=Object(s.c)(t,"btn_pop");Object(s.e)(".pop").forEach((function(e){null===a&&e.classList.remove("act")})),null!==e&&e.classList.add("act")}}}(e)})),T(storage.popBtns,"click",(function(){let e=this.dataset.target,t=this.dataset.type,a=Object(s.d)(e),n=this.getBoundingClientRect(),o=storage.popOptions.getBoundingClientRect();if(a.removeAttribute("style"),a.classList.toggle("act"),"position"===t&&storage.windowWidth>storage.changePint){let e=Math.floor(n.left-o.left),t=storage.popOptions.getBoundingClientRect().height;a.style.cssText=`transform:translate(${e}px, ${t}px)`}else this.classList.toggle("act")})),T(storage.popCloseBtns,"click",(function(){let e=this.dataset.target,t=Object(s.d)(e);t.removeAttribute("style"),t.classList.toggle("act")})),document.addEventListener("keydown",(function(e){if("HTMLBodyElement"===document.activeElement.constructor.name){let t;!0!==e.ctrlKey&&!0!==e.metaKey||(t=!0),"z"===e.key&&(!0===t||!0===t&&!0===e.shiftKey)&&e.preventDefault()}})),T(storage.contentArea,"paste",(function(e){e.preventDefault(),L(e)})),window.addEventListener("scroll",(function(e){storage.windowWidth>storage.changePint&&(document.activeElement.blur(),storage.popOptions.classList.remove("act"))})),T(storage.contentArea,"click",(function(e){clearTimeout(t),t=setTimeout(()=>{0!==e.button&&!1!==e.isTrusted||(storage.edited=!0,d(e.target,"click"),c(e.target),function(e){let t=e.constructor.name,a=e.classList;if("HTMLButtonElement"===t){let e=document.querySelector(".lastset .item_table"),t=e.querySelector("colgroup"),s=e.querySelectorAll("col").length,n=e.querySelectorAll("tr"),o=e.querySelector("tbody");switch(!0){case a.contains("btn_col_add"):n.forEach((function(e){let t=e.querySelector("*:nth-child(1)").dataset.y;e.insertAdjacentHTML("beforeend",`<td contenteditable="true" data-x="${s}" data-y="${t}"></td>`)})),t.insertAdjacentHTML("beforeend",'<col class="size_100">');break;case a.contains("btn_col_del"):if(s>1){let e=t.querySelector("*:last-child");n.forEach((function(e){e.querySelector("*:last-child").remove()})),e.remove()}break;case a.contains("btn_row_add"):let e="<tr>";for(let t=0;t<s;t+=1)e+=`<td contenteditable="true" data-x="${t}" data-y="${n.length}"></td>`;e+="</tr>",o.insertAdjacentHTML("beforeend",e);break;case a.contains("btn_row_del"):n.length>1&&o.querySelector("tr:last-child").remove()}}}(e.target))},150)})),T(storage.contentArea,"mouseover",(function(e){clearTimeout(a),a=setTimeout(()=>{storage.windowWidth>storage.changePint&&(d(e.target,"mouseover"),c(e.target))},250)})),T(storage.contentArea,"keydown",(function(e){storage.edited=!0,async function(e){let t=window.getSelection(),a=e.key,n=e.shiftKey,o="HTMLBodyElement"!==document.activeElement.constructor.name&&document.activeElement,i=Object(s.b)(o),l=Object(s.c)(o,"item"),d=o.tagName,p=o.textContent;switch(!1!==o&&(storage.activeElement=storage.activeElement),!0){case"Enter"===a&&!1!==o:if(!0!==n&&(e.preventDefault(),0===storage.enterCount)){if(""===p)if("LI"===d){let e=l.querySelectorAll("li").length;g(l),e>1&&o.remove();let t=l.nextElementSibling;storage.activeElement=t,c(t),r(t.getBoundingClientRect(),"text")}else{g(l);let e=l.nextElementSibling;storage.activeElement=e,c(e),r(e.getBoundingClientRect(),"text")}else if("LI"===d)o.insertAdjacentHTML("afterend",storage.HTMLChildList.replace("[content]","")),setTimeout(()=>{o.nextElementSibling.focus()},10);else{g(l);let e=l.nextElementSibling;storage.activeElement=e,c(e),r(e.getBoundingClientRect(),"text")}storage.enterCount+=1}break;case"Tab"===a&&!1!==o:if(!0===n)if(!0===o.classList.contains("title"))e.preventDefault();else{let e=l.previousElementSibling;c(e),r(e.getBoundingClientRect(),e.dataset.type)}else{if(storage.contentArea.querySelector(".item:nth-last-child(1)")===l)e.preventDefault();else{let e=l.nextElementSibling;c(e),r(e.getBoundingClientRect(),e.dataset.type)}}break;case"Backspace"===a&&!1!==o:if(0===t.focusOffset&&0===t.baseOffset&&(t.focusNode===l.childNodes[0]||t.focusNode===l||"LI"===o.tagName)){e.preventDefault();let t=l.previousElementSibling,a=t.childNodes,s=a.length,n=t.tagName;if(""===p){if("P"===d&&"BLOCKQUOTE"!==l.tagName){if("UL"===n||"OL"===n){let e=t.children[t.childElementCount-1],a=e.childNodes,s=a.length;if(s>0){let e=a[s-1];u(e,e.length)}else u(e,0);l.remove(),t.classList.add("lastset"),c(e),"UL"===n?r(t.getBoundingClientRect(),"list_u"):"OL"===n&&r(t.getBoundingClientRect(),"list_o")}else if("P"===n){if(s>0){let e=a[s-1];u(e,e.length)}else u(t,0);l.remove(),t.classList.add("lastset"),c(t),r(t.getBoundingClientRect(),"text")}storage.activeElement=t}else if("LI"===d){let e=i.previousElementSibling,o=l.querySelectorAll("li").length;if(null===e){let e,d,g,p=!1;if("P"===n)s>0?(e=a[s-1],d=e.length):(e=t,d=0),g="text",p=!0;else if("UL"===n||"OL"===n){let a=t.querySelector("li:last-child").childNodes,s=a.length;s>0?(e=a[s-1],d=e.length):(e=t.querySelector("li:last-child"),d=0),"UL"===n?g="list_u":"OL"===n&&(g="list_o"),p=!0}!0===p&&(u(e,d),o>1?i.remove():l.remove(),c(e),r(t.getBoundingClientRect(),g),storage.activeElement=t)}else{let t=e.childNodes,a=t.length;if(a>0){let e=t[a-1];u(e,e.length)}else u(e,0);i.remove(),storage.activeElement=e}}}else if("P"===d&&"BLOCKQUOTE"!==l.tagName){let e=l.innerHTML;if("UL"===n||"OL"===n){let a=t.children[t.childElementCount-1],s=a.childNodes,o=s.length,i=o-1,d=s[i].length;a.innerHTML+=e,o>0?(a=a.childNodes[i],u(a,d)):u(t,0),l.remove(),t.classList.add("lastset"),"UL"===n?r(t.getBoundingClientRect(),"list_u"):"OL"===n&&r(t.getBoundingClientRect(),"list_o"),c(t)}else if("P"===n){if(s>0){let n=s-1,o=a[n].length;t.innerHTML+=e,u(t.childNodes[n],o)}else u(t,0);l.remove(),t.classList.add("lastset"),c(t),r(t.getBoundingClientRect(),"text")}storage.activeElement=t}else if("LI"===d){let e=i.innerHTML,o=i.previousElementSibling,d=l.querySelectorAll("li").length;if(null===o){let o,g,p,m=!1;if("P"===n)t.innerHTML+=e,s>0?(o=t.childNodes[s-1],g=a[s-1].length):(o=t,g=0),p="text",m=!0;else if("UL"===n||"OL"===n){let a=t.querySelector("li:last-child"),s=a.childNodes,i=s.length,l=s[i-1].length;a.innerHTML+=e,i>0?(o=a.childNodes[i-1],g=l):(o=t.querySelector("li:last-child"),g=0),"UL"===n?p="list_u":"OL"===n&&(p="list_o"),m=!0}!0===m&&(u(o,g),d>1?i.remove():l.remove(),c(t),r(t.getBoundingClientRect(),p),storage.activeElement=t)}else{let t=o.childNodes,a=t.length,s=t[a-1].length;if(o.innerHTML+=e,a>0){u(o.childNodes[a-1],s)}else u(o,0);i.remove(),storage.activeElement=o}}}}}(e),setTimeout(()=>{storage.enterCount=0},150)})),T(storage.contentAddBtn,"click",(function(){let e=this.dataset.value,t=storage.contentArea.childElementCount,a=Object(s.d)(".lastset"),n=null===a?storage.contentArea.children[t-1]:a;switch(e){case"text":g(n);break;case"image":p(n,storage.imageIconId,"image","Add on image"),storage.fileInput.dataset.type="image",storage.fileInput.setAttribute("accept","image/*"),storage.fileInput.click();break;case"sticker":!function(e,t){l(e);let a=storage.HTMLsticker.replace("[el]",t.innerHTML);e.insertAdjacentHTML("afterend",a)}(n,this);break;case"youtube":p(n,storage.youtubeIconId,"youtube","Add Youtube");break;case"codepen":p(n,storage.codepenIconId,"codepen","Add Codepen");break;case"bulletedlist":m(n,"ul");break;case"numberedlist":m(n,"ol","1");break;case"quote":!function(e){l(e),e.insertAdjacentHTML("afterend",storage.HTMLQuote),e.nextElementSibling.children[0].focus()}(n);break;case"table":!function(e){l(e),e.insertAdjacentHTML("afterend",storage.HTMLTable),e.nextElementSibling.querySelector("caption").focus()}(n);break;case"codeblock":!function(e){l(e),e.insertAdjacentHTML("afterend",storage.HTMLCodeBlock),e.nextElementSibling.children[0].focus()}(n);break;case"link":h(n,storage.linkBoxData),storage.popLink.classList.remove("act"),storage.popLink.querySelector(".url").value="",storage.popLink.querySelector(".view").innerHTML="",storage.popLink.querySelector(".btn_submit").setAttribute("disabled","true")}})),T(storage.viewBtn,"click",(function(e){storage.contentArea.classList.toggle("mobile"),this.classList.toggle("act")})),T(Object(s.d)(storage.popLinkName+" .btn_check"),"click",(async function(){let e={},t=Object(s.d)(storage.popLinkName+" .view"),a=Object(s.d)(storage.popLinkName+" .btn_submit"),n=Object(s.d)(storage.popLinkName+" .url").value;if(!0===storage.urlReg.test(n))if(e.url=n,""===storage.linkBoxApi){let s=(await y("https://api.allorigins.win/get?url="+encodeURIComponent(n))).contents;if(null!==s){let o=new RegExp('property=\\"og:title\\"',"g"),i=new RegExp('([^])*\\<title>([^"]*)<\\/title>([^]*)',"g"),l=new RegExp('([^]*)\\<meta property=\\"og:title\\" content=\\"([^"]*)(?=\\")"([^]*)',"g"),r=new RegExp('property=\\"og:image\\"',"g"),c=new RegExp('([^])*\\<meta name=\\"image\\" content=\\"([^"]*)"\\>([^]*)',"g"),d=new RegExp('([^])*\\<meta property=\\"og:image\\" content=\\"([^"]*)(?=\\")([^]*)',"g"),g=new RegExp('property=\\"og:description\\"',"g"),u=new RegExp('([^])*\\<meta name=\\"description\\" content=\\"([^"]*)(?=\\")([^]*)',"g"),p=new RegExp('([^])*\\<meta property=\\"og:description\\" content=\\"([^"]*)(?=\\")([^]*)',"g");if(o.test(s)?e.title=s.replace(l,"$2"):e.title=s.replace(i,"$2"),r.test(s))e.img=s.replace(d,"$2");else{let t=s.replace(c,"$2");t.length>500?e.img="":e.img=t}if(g.test(s))e.description=s.replace(p,"$2");else{let t=s.replace(u,"$2");t.length>500?e.description="":e.description=t}n.indexOf("://")>-1?e.domain=n.split("/")[2]:e.domain=n.split("/")[0],e.domain=e.domain.split(":")[0],storage.linkBoxData=e,a.removeAttribute("disabled"),h(t,e,"innerHTML"),t.querySelector(".item").classList.remove("lastset")}else a.setAttribute("disabled","true"),t.innerHTML=storage.messageNoData}else{let e=new FormData;e.append("url",n);let s=await y(storage.linkBoxApi,{method:"POST",body:e});!0===s.result?(storage.linkBoxData=s,a.removeAttribute("disabled"),h(t,s,"innerHTML")):(a.setAttribute("disabled","true"),t.innerHTML=s.message)}else alert(storage.messageWrongURL)})),T(storage.contentDelBtn,"click",(function(){let e=Object(s.d)(".lastset");if(null!==e){e.remove(),storage.popOptions.classList.remove("act"),1===storage.contentArea.childElementCount&&g(storage.contentArea,"","beforeend")}else alert(storage.messageNotSelect)})),T(storage.fontSizeSelect,"change",(function(){!function(e){let t=i(storage.activeElement),a=o(t.classList.value,"size");"default"===e?""!==a&&t.classList.remove(a):(""!==a&&t.classList.remove(a),t.classList.add(e))}(this.value)})),T(storage.btnColor,"click",(function(){!function(e){let t=["I","B","S","U","A","SPAN"],a=storage.activeElement,s=a.tagName,n=i(a);if(window.getSelection().focusNode===window.getSelection().baseNode)if(t.indexOf(s)>0){let t=o(a.classList.value,"color");if(""!==t&&a.classList.remove(t),"default"!==e)a.classList.add(e);else if("SPAN"===s){let e=a.textContent;a.insertAdjacentText("afterend",e),a.remove(),n.innerHTML=n.innerHTML,storage.activeElement=storage.wrap}storage.btnColorSelect.dataset.class=e}else{let t=o(n.classList.value,"color");storage.startTextCursor===storage.endTextCursor?(""!==t&&n.classList.remove(t),"default"!==e&&n.classList.add(e),storage.btnColorSelect.dataset.class=e):w("color",null,e)}else alert(storage.messageWrongNode)}(this.dataset.class)})),T(storage.addLinkBtn,"click",(function(){v()})),T(storage.unlinkBtn,"click",(function(){!function(){let e=storage.activeElement,t=i(e);if("HTMLAnchorElement"===e.constructor.name){let a=e.textContent;e.insertAdjacentText("afterend",a),e.remove(),t.innerHTML=t.innerHTML}else alrt(storage.messageNotAnchorTag)}()})),T(storage.boldBtn,"click",(function(){x("b","B","bold")})),T(storage.italicBtn,"click",(function(){x("i","I","italic")})),T(storage.underlineBtn,"click",(function(){x("u","U","underline")})),T(storage.strikeBtn,"click",(function(){x("s","S","strike")})),T(storage.wordblockBtn,"click",(function(){!function(){if(window.getSelection().focusNode===window.getSelection().baseNode){let e=storage.activeElement,t=e.tagName,a=i(e),s=e.textContent;"CODE"===t?(e.insertAdjacentText("afterend",s),e.remove(),a.innerHTML=a.innerHTML,storage.activeElement=storage.wrap):w("wordblock")}else alert(storage.messageWrongNode)}()})),T(storage.widthInput,"keyup",(function(e){if("Enter"===e.key){!function(e,t){let a=Object(s.d)(".lastset .img"),n=storage.messageExceedSize.replace("[size]",storage.maxImageWidth);if(null!==a)if(storage.numberReg.test(t)){t<=storage.maxImageWidth?a.setAttribute("width",t):(alert(n),e.value=storage.maxImageWidth,a.setAttribute("width",storage.maxImageWidth)),r(Object(s.d)(".lastset").getBoundingClientRect(),"image")}else alert(storage.messageWrongValue);else alert(storage.messageNotSelecImage)}(this,this.value)}})),T(storage.heightInput,"keyup",(function(e){if("Enter"===e.key){let e=this.value,t=Object(s.d)(".lastset .iframe"),a=storage.messageExceedSize.replace("[size]",storage.maxCodepenHeight);if(null!==t)if(storage.numberReg.test(e)){e<=storage.maxCodepenHeight?t.setAttribute("height",e):(alert(a),this.value=storage.maxCodepenHeight,t.setAttribute("height",storage.maxCodepenHeight)),r(Object(s.d)(".lastset").getBoundingClientRect(),"codepen")}else alert(storage.messageWrongValue);else alert(storage.messageNotSelecCodepen)}})),T(storage.listTypeSelect,"change",(function(){let e=this.value,t=Object(s.d)(".lastset");!1!==t&&t.setAttribute("type",e)})),T(storage.colSizeSelect,"change",(function(){let e=this.value,t=storage.activeElement.constructor.name,a=Object(s.d)(".lastset");if(("HTMLTableCellElement"===t||"HTMLTableCaptionElement"===t)&&null!==a){let t=parseInt(storage.activeElement.dataset.x)+1,s=a.querySelector(`col:nth-child(${t})`),n=o(s.classList.value,"size");s.classList.remove(n),s.classList.add(e)}})),T(storage.themeSelect,"change",(function(){let e=this.value,t=Object(s.d)(".lastset");null!==t&&(t.dataset.theme=e)})),T(storage.languageSelect,"change",(function(){let e=this.value,t=Object(s.d)(".lastset");if(null!==t){let a=t.childNodes[0];t.dataset.lang=e,a.classList.value="",a.classList.add(e),hljs.highlightBlock(a)}})),T(storage.changeThBtn,"click",(function(){b("th")})),T(storage.changeTdBtn,"click",(function(){b("td")})),T(storage.textAlgin,"click",(function(){!function(e){let t=null===i(storage.activeElement)?Object(s.c)(storage.activeElement,"item"):i(storage.activeElement),a=o(t.classList.value,"align");""!==a&&t.classList.remove(a),t.classList.add(e)}(this.dataset.value)})),T(storage.changeUrlBtn,"click",(function(){let e=storage.urlInput.value,t=Object(s.d)(".lastset"),a=t.dataset.type;switch(!0){case!1===storage.urlReg.test(e):alert(storage.messageWrongURL);break;case void 0===t:alert(storage.messageNotSelect);break;case"youtube"===a:if(storage.youtubeReg.test(e)){let a=e.replace(storage.youtubeCodeReg,"$7");t.querySelector(".video").setAttribute("src","https://www.youtube.com/embed/"+a)}else alert(storage.messageWrongUrlType);break;case"codepen"===a:if(storage.codepenReg.test(e)){let a=t.querySelector(".iframe"),s=a.getAttribute("height"),n=e.replace(storage.codepenCodeReg,"$2"),o=e.replace(storage.codepenCodeReg,"$4");a.setAttribute("src",`https://codepen.io/${n}/embed/${o}?height=${s}&theme-id=${storage.codepenTheme}&default-tab=result`)}else alert(storage.messageWrongUrlType);break;case"btn"===a:let s=t.dataset.value;"youtube"===s?(!function(e,t,a="afterend"){l(e);let s=t.replace(storage.youtubeCodeReg,"$7"),n=storage.HTMLYoutube.replace("[src]","https://www.youtube.com/embed/"+s);e.insertAdjacentHTML(a,n)}(t,e),t.remove(),storage.activeElement=storage.contentArea):"codepen"===s&&(!function(e,t,a="afterend",s=300){l(e);let n=t.replace(storage.codepenCodeReg,"$2"),o=t.replace(storage.codepenCodeReg,"$4"),i=storage.HTMLCodepen.replace("[src]",`https://codepen.io/${n}/embed/${o}?height=${s}&theme-id=${storage.codepenTheme}&default-tab=result`).replace("[height]",s);e.insertAdjacentHTML(a,i)}(t,e),t.remove(),storage.activeElement=storage.contentArea)}})),T(storage.fileInput,"change",(async function(){let e=storage.contentArea,t=this.files,a=new FormData,n=this.dataset.type,o=e.dataset.idx,i=e.dataset.tempIdx;a.append("request_type","upload"),a.append("file_type",n);for(let e of t)a.append("file[]",e);a.append("article_idx",o),a.append("temp_idx",i);let l=await y(storage.mediaUploadURL,{method:"POST",body:a});if(!0===l.result){let e=null===Object(s.d)(".lastset")?Object(s.d)(storage.contentAreaName+" > *:nth-last-child(1)"):Object(s.d)(".lastset"),t=l.list,a="";for(let s of t){let t="y"===s.webp;a+=storage.HTMLMediaRow.replace(/\[idx\]/g,s.idx).replace("[webp]",t).replace("[height]",s.height).replace("[width]",s.width).replace("[src]",`${s.src}${s.name}.${s.format}`).replace("[alt]",s.alt).replace("[name]",s.alt),f(e,{idx:s.idx,src:`${s.src}${s.name}`,webp:t,format:s.format,alt:s.alt,width:s.width,height:s.height})}e.classList.contains("btn")&&e.remove(),storage.mediaList.insertAdjacentHTML("beforeend",a),storage.popMedia.classList.add("act"),this.value=""}else alert(l.message)})),T(storage.addMediaListBtn,"click",(function(){storage.fileInput.dataset.type="image",storage.fileInput.setAttribute("accept","image/*"),storage.fileInput.click()})),T(storage.popMedia,"click",(async function(e){let t,a,n=e.target,o=Object(s.c)(n,"btn_add_media"),i=this.querySelector("*[contenteditable]");switch(n.tagName){case"IMG":let e=n.getAttribute("src"),l=null===Object(s.d)(".lastset")?Object(s.d)(storage.contentAreaName+" > *:nth-last-child(1)"):Object(s.d)(".lastset");t={width:n.getAttribute("width"),height:n.dataset.height,webp:o.dataset.webp,alt:o.querySelector(".name").textContent,src:e.replace(storage.srcReg,"$1"),format:e.replace(storage.srcReg,"$2")},f(l,t);break;case"P":if(null!==i){o=Object(s.c)(i,"btn_add_media"),a=o.querySelector(".img"),i.removeAttribute("contenteditable"),t={request_type:"update",idx:o.dataset.idx,width:a.getAttribute("width"),height:a.dataset.height,webp:o.dataset.webp,alt:o.querySelector(".name").textContent,src:a.getAttribute("src").replace(storage.srcReg,"$1"),format:a.getAttribute("src").replace(storage.srcReg,"$2")};let e=await y(storage.mediaUpdateURL,{method:"POST",body:t},"json");if(!0===e.result){let e=a.getAttribute("src");storage.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.setAttribute("alt",i.textContent)}))}else alert(e.message)}n.setAttribute("contenteditable",!0),n.focus();break;case"BUTTON":if(!1===n.classList.contains(storage.addMediaListBtnName.substring(1))){let e=o.dataset.idx;if(!0===confirm(storage.messageDelImage)){let t=await y(`${storage.mediaDelURL}/${e}`,{method:"delete"});if(!0===t.result){let e=o.querySelector(".img").getAttribute("src");storage.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.remove(),o.remove()}))}else alert(t.message)}}break;default:if(null!==i){o=Object(s.c)(i,"btn_add_media"),a=o.querySelector(".img"),i.removeAttribute("contenteditable"),t={request_type:"update",idx:o.dataset.idx,width:a.getAttribute("width"),height:a.dataset.height,webp:o.dataset.webp,alt:o.querySelector(".name").textContent,src:a.getAttribute("src").replace(storage.srcReg,"$1"),format:a.getAttribute("src").replace(storage.srcReg,"$2")};let e=await y(storage.mediaUpdateURL,{method:"POST",body:t},"json");if(!0===e.result){let e=a.getAttribute("src");storage.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.setAttribute("alt",i.textContent)}))}else alert(e.message)}}})),T(storage.popMedia,"keydown",(async function(e){if("Enter"===e.key){e.preventDefault();let t=Object(s.c)(e.target,"btn_add_media"),a=t.querySelector(".img"),n=e.target.textContent,o={request_type:"update",idx:t.dataset.idx,width:a.getAttribute("width"),height:a.dataset.height,webp:t.dataset.webp,alt:n,src:a.getAttribute("src").replace(storage.srcReg,"$1"),format:a.getAttribute("src").replace(storage.srcReg,"$2")},i=await y(storage.mediaUpdateURL,{method:"POST",body:o},"json");if(!0===i.result){let e=t.querySelector(".img").getAttribute("src");storage.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.setAttribute("alt",n)}))}else alert(i.message);e.target.removeAttribute("contenteditable")}})),T(storage.languageChangeBtn,"click",(function(){let e=storage.langStatus,t=_(),a=this.dataset.value,s=storage.contentData[a];if(storage.contentData[e]=t,storage.langStatus=a,storage.languageChangeBtn.forEach((function(e){e.classList.remove("act")})),this.classList.add("act"),s.length>0)S(s);else{S(!0===confirm(storage.messageDuplicateContent)?t:[{type:"title",class:["title"],textContent:""},{type:"text",class:["item"],textContent:""}])}}))}function T(e,t,a){if(null!==e){"NodeList"===("object"==typeof e&&"NodeList"===e.constructor.name?"NodeList":"element")?e.forEach((function(e){e.addEventListener(t,a)})):e.addEventListener(t,a)}}function S(e){let t=function(e){let t="";return e.forEach((function(e){switch(e.type){case"title":t+=`<h1 class="${e.class.join(" ")}" contenteditable="true" data-type="${e.type}">${e.textContent}</h1>`;break;case"text":t+=`<p class="${e.class.join(" ")}" contenteditable="true" data-type="${e.type}">${e.textContent}</p>`;break;case"image":!0===storage.useWebp?(t+=`<picture class="${e.class.join(" ")}" data-type="${e.type}">`,!0===e.hasWebp&&(t+=`<source srcset="${e.src}.webp" type="image/webp">`),t+=`<img src="${e.src}.${e.defaultFormat}" width="${e.size}" alt="${e.alt}" class="img"></picture>`):t+=`<div class="${e.class.join(" ")}" data-type="image"><img src="${e.src}.${e.defaultFormat}" width="${e.size}" alt="${e.alt}" class="img"></div>`;break;case"btn":"image"===e.value?(t+=`<div class="btn" data-type="${e.type}" data-value="${e.value}">`,"svg"===e.icon.type?t+=`<svg viewBox="${e.icon.viewBox}" class="${e.icon.class.join(" ")}"><use class="path" xlink:href="${e.icon.url}" href="${e.icon.url}"></use></svg>`:t+=`<img src="${e.icon.url}" alt="image icon" class="">`,t+=e.textContent.replace(/\n/i,"").replace(/^\s*/i,"").replace(/\s*$/i,"")+"</div>"):"youtube"===e.value?(t+=`<div class="btn" data-type="${e.type}" data-value="${e.value}">`,"svg"===e.icon.type?t+=`<svg viewBox="${e.icon.viewBox}" class="${e.icon.class.join(" ")}"><use class="path" xlink:href="${e.icon.url}" href="${e.icon.url}"></use></svg>`:t+=`<img src="${e.icon.url}" alt="youtube icon" class="">`,t+=e.textContent.replace(/\n/i,"").replace(/^\s*/i,"").replace(/\s*$/i,"")+"</div>"):"codepen"===e.value&&(t+=`<div class="btn" data-type="${e.type}" data-value="${e.value}">`,"svg"===e.icon.type?t+=`<svg viewBox="${e.icon.viewBox}" class="${e.icon.class.join(" ")}"><use class="path" xlink:href="${e.icon.url}" href="${e.icon.url}"></use></svg>`:t+=`<img src="${e.icon.url}" alt="codepen icon" class="">`,t+=e.textContent.replace(/\n/i,"").replace(/^\s*/i,"").replace(/\s*$/i,"")+"</div>");break;case"youtube":t+=`<div class="${e.class.join(" ")}" data-type="${e.type}"><iframe src="${e.src}" allow="${e.allow}" allowfullscreen="" class="video"></iframe></div>`;break;case"codepen":t+=`<div class="${e.class.join(" ")}" data-type="${e.type}"><iframe height="${e.height}" title="" src="${e.src}" allowfullscreen="" class="iframe"></iframe></div>`;break;case"list":let a="";"ol"===e.tag?a="list_o":"ul"===e.tag&&(a="list_u"),null===e.listType?t+=`<${e.tag} class="${e.class.join(" ")}" data-type="${a}">`:t+=`<${e.tag} type="${e.listType}" class="${e.class.join(" ")}" data-type="${a}">`,e.child.forEach((function(e){e.class.length>0?t+=`<li class="${e.class.join(" ")}" contenteditable="true">${e.textContent}</li>`:t+=`<li contenteditable="true">${e.textContent}</li>`})),t+=`</${e.tag}>`;break;case"quote":t+=`<blockquote class="${e.class.join(" ")}" data-type="${e.type}"><p class="text" contenteditable="true">${e.text}</p><p class="author" contenteditable="true">${e.author}</p></blockquote>`;break;case"table":let s=0;t+=`<div class="${e.class.join(" ")}" data-type="${e.type}"><div class="scroll"><table class="item_table"><caption contenteditable="true">${e.caption}</caption><colgroup>`,e.colgroup.forEach((function(e){t+=`<col class="${e}">`})),t+="</colgroup><tbody>",e.child.forEach((function(e){let a=0;t+="<tr>",e.forEach((function(e){e.class.length>0?t+=`<${e.tag} class="${e.class.join(" ")}" contenteditable="true" data-x="${a}" data-y="${s}">${e.textContent}</${e.tag}>`:t+=`<${e.tag} contenteditable="true" data-x="${a}" data-y="${s}">${e.textContent}</${e.tag}>`,a+=1})),t+="</tr>",s+=1})),t+='</tbody></table></div><button class="btn btn_col_add">Add col</button><button class="btn btn_col_del">Remove col</button><button class="btn btn_row_add">Add row</button><button class="btn btn_row_del">Remove row</button></div>';break;case"codeblock":t+=`<pre class="${e.class.join(" ")}" data-type="${e.type}" data-theme="${e.theme}" data-lang="${e.lang}"><code class="${e.code.class.join(" ")}" contenteditable="true">${e.code.innerHTML}</code></pre>`;break;case"link_box":t+=`<div class="${e.class.join(" ")}" data-type="${e.type}"><a href="${e.url}" target="_blank" class="link_box clearfix" draggable="false"><div class="img_area"><img src="${e.imgSrc}" alt="미리보기 이미지" class="img" draggable="false"></div><div class="text_area"><p class="link_title ellipsis">${e.title}</p><p class="link_description ellipsis">${e.description}</p><p class="link_domain">${e.domain}</p></div></a></div>`;break;default:t+=e.other}})),t}(e);storage.contentArea.innerHTML=t}function _(){return function(e){let t=[];return e.forEach(e=>{let a=e.dataset.type;switch(!0){case"title"===a:t.push({type:"title",class:[...e.classList],textContent:e.textContent});break;case"text"===a:t.push({type:"text",class:[...e.classList],textContent:e.innerHTML});break;case"image"===a:let s="PICTURE"===e.tagName,n=e.querySelector(".img"),o=n.getAttribute("src");t.push({type:"image",class:[...e.classList],hasWebp:s,size:n.getAttribute("width"),alt:n.getAttribute("alt"),src:o.replace(storage.srcReg,"$1"),defaultFormat:o.replace(storage.srcReg,"$2")});break;case"youtube"===a:let i=e.querySelector(".video");t.push({type:"youtube",class:[...e.classList],src:i.getAttribute("src"),allow:i.getAttribute("allow")});break;case"codepen"===a:let l=e.querySelector(".iframe");t.push({type:"codepen",class:[...e.classList],src:l.getAttribute("src"),height:l.getAttribute("height"),title:l.getAttribute("title")});break;case"list_u"===a||"list_o"===a:let r=e.querySelectorAll("li"),c=[];r.forEach((function(e){c.push({class:[...e.classList],textContent:e.textContent})})),t.push({type:"list",class:[...e.classList],tag:e.tagName.toLowerCase(),listType:e.getAttribute("type"),child:c});break;case"quote"===a:let d=e.querySelector(".text").textContent,g=e.querySelector(".author").textContent;t.push({type:"quote",class:[...e.classList],text:d,author:g});break;case"table"===a:let u=[],p=[],m=e.querySelector("caption").textContent,b=e.querySelectorAll("col"),h=e.querySelectorAll("tr");b.forEach((function(e){u.push(e.classList.value)})),h.forEach((function(e){let t=[],a=e.childElementCount,s=e.children;for(let e=0;e<a;e+=1)t.push({tag:s[e].tagName.toLowerCase(),class:[...s[e].classList],textContent:s[e].textContent});p.push(t)})),t.push({type:"table",class:[...e.classList],caption:m,colgroup:u,child:p});break;case"codeblock"===a:let f=e.dataset.theme,y=e.dataset.lang,L=e.querySelector("code");t.push({type:"codeblock",class:[...e.classList],theme:f,lang:y,code:{class:[...L.classList],innerHTML:L.innerHTML}});break;case"link_box"===a:let v=e.querySelector(".link_box").getAttribute("href"),x=e.querySelector(".img").getAttribute("src"),w=e.querySelector(".link_title").textContent,k=e.querySelector(".link_description").textContent,T=e.querySelector(".link_domain").textContent;t.push({type:"link_box",class:[...e.classList],url:v,imgSrc:x,title:w,description:k,domain:T});break;case"btn"===a:let S,_=e.querySelector(".icon"),$=_.tagName.toLowerCase();S="svg"===$?_.querySelector("use").getAttribute("href"):_.getAttribute("src"),t.push({type:"btn",value:e.dataset.value,textContent:e.textContent,icon:{type:$,viewBox:_.getAttribute("viewBox"),class:[..._.classList],url:S}});break;case"sticker"===a:t.push({type:"sticker",code:e.innerHTML,class:[...e.classList]});break;default:t.push({type:"other",other:e.outerHTML})}}),t}(Object(s.e)(storage.contentAreaName+" > *"),storage.srcReg)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(0);class n{constructor(e,t){this.enterCount=0,this.startTextCursor=0,this.endTextCursor=0,this.activeElement,this.focusNode,this.baseNode,this.edited=!1,this.langStatus="kr",this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.changePint="number"!=typeof t.changePint?1120:t.changePint,this.maxImageWidth="number"!=typeof t.maxImageWidth?800:t.maxImageWidth,this.maxCodepenHeight="number"!=typeof t.maxCodepenHeight?1e3:t.maxCodepenHeight,this.useWebp="boolean"!=typeof t.useWebp||t.useWebp,this.loading="boolean"!=typeof t.loading||t.loading,this.codepenTheme="string"!=typeof t.codepenTheme?"dark":t.codepenTheme,this.multiUpload="boolean"==typeof t.multiUpload&&t.multiUpload,this.mediaUploadURL="string"!=typeof t.mediaUploadURL?"":t.mediaUploadURL,this.mediaUpdateURL="string"!=typeof t.mediaUpdateURL?"":t.mediaUpdateURL,this.mediaDelURL="string"!=typeof t.mediaDelURL?"":t.mediaDelURL,this.linkBoxApi="string"!=typeof t.linkBoxApi?"":t.linkBoxApi,this.defaultLinkBoxImage="string"!=typeof t.defaultLinkBoxImage?"https://via.placeholder.com/600x300.png":t.defaultLinkBoxImage,this.iconSize="string"!=typeof t.iconSize?"0 0 50 50":t.iconSize,this.makeLinkBoxType="self"!=typeof t.makeLinkBoxType?"self":"api",this.makeLinkBoxURL="string"!=typeof t.makeLinkBoxURL?"":t.makeLinkBoxURL,this.imageIconId="string"!=typeof t.imageIconId?"#icon_image":t.imageIconId,this.youtubeIconId="string"!=typeof t.youtubeIconId?"#icon_youtube":t.youtubeIconId,this.codepenIconId="string"!=typeof t.codepenIconId?"#icon_codepen":t.codepenIconId,this.contentAreaName="string"!=typeof t.contentArea?".content_area":t.contentArea,this.popOptionsName="string"!=typeof t.popOptions?".pop_options":t.popOptions,this.popLinkName="string"!=typeof t.popLink?".pop_link_box":t.popLink,this.stickerListName="string"!=typeof t.stickerList?".pop_sticker":t.stickerList,this.addMediaListBtnName="string"!=typeof t.addMediaListBtn?".btn_add_media_list":t.addMediaListBtn,this.wrap=Object(s.a)(e,".editor-dragon"),this.contentArea=Object(s.a)(t.contentArea,".content_area"),this.mediaList=Object(s.a)(t.mediaList,".pop_media .media_list"),this.popMedia=Object(s.a)(t.popMedia,".pop_media"),this.popLang=Object(s.a)(t.popLang,".pop_lang"),!0===this.loading&&(this.popBgArea=Object(s.a)(t.popBgArea,".pop_bg"),this.lodingArea=Object(s.a)(t.lodingArea,".pop_loding")),this.popOptions=Object(s.a)(t.popOptions,".pop_options"),this.popLink=Object(s.a)(t.popLink,".pop_link_box"),this.fileInput=Object(s.a)(t.fileInput,".file_check"),this.uploadForm=Object(s.a)(t.uploadForm,".file_uploader"),this.contentAddBtn=Object(s.a)(t.contentAddBtn,".btn_add_content","multi"),this.viewBtn=Object(s.a)(t.viewBtn,".btn_mod"),this.popBtns=Object(s.a)(t.popBtn,".btn_pop","multi"),this.popCloseBtns=Object(s.a)(t.popCloseBtns,".btn_pop_close","multi"),this.fontSizeSelect=Object(s.a)(t.fontSizeSelect,".select_font_size"),this.btnColorSelect=Object(s.a)(t.colorSelect,".select_color"),this.btnColor=Object(s.a)(t.colorSelect,".btn_set_color","multi"),this.textAlgin=Object(s.a)(t.textAlgin,".btn_text_algin","multi"),this.listTypeSelect=Object(s.a)(t.listTypeSelect,".select_list_type"),this.colSizeSelect=Object(s.a)(t.colSizeSelect,".select_col"),this.themeSelect=Object(s.a)(t.themeSelect,".select_theme"),this.languageSelect=Object(s.a)(t.languageSelect,".select_language"),this.changeThBtn=Object(s.a)(t.changeThBtn,".btn_change_th"),this.changeTdBtn=Object(s.a)(t.changeTdBtn,".btn_change_td"),this.widthInput=Object(s.a)(t.widthInput,".options_width .value"),this.heightInput=Object(s.a)(t.heightInput,".options_height .value"),this.urlInput=Object(s.a)(t.urlInput,".options_url .value"),this.changeUrlBtn=Object(s.a)(t.changeUrlBtn,".btn_url_change"),this.addLinkBtn=Object(s.a)(t.addLinkBtn,".btn_url_link"),this.unlinkBtn=Object(s.a)(t.unlinkBtn,".btn_url_unlink"),this.boldBtn=Object(s.a)(t.boldBtn,".btn_bold"),this.italicBtn=Object(s.a)(t.italicBtn,".btn_italic"),this.underlineBtn=Object(s.a)(t.underlineBtn,".btn_underline"),this.strikeBtn=Object(s.a)(t.strikeBtn,".btn_strike"),this.wordblockBtn=Object(s.a)(t.wordblockBtn,".btn_wordblock"),this.contentDelBtn=Object(s.a)(t.contentDelBtn,".btn_del_content"),this.languageChangeBtn=Object(s.a)(t.languageChangeBtn,".btn_chang_lang","multi"),this.addMediaListBtn=Object(s.a)(t.addMediaListBtn,".btn_add_media_list"),this.HTMLTextBlock='<p class="item item_text lastset" contenteditable="true" data-type="text">[content]</p>',this.HTMLBtn='<div class="btn lastset" data-type="btn" data-value="[type]"><svg viewbox="[icon_size]" class="icon"><use class="path" xlink:href="[icon_id]" href="[icon_id]" /></svg>[text]</div>',this.HTMLList='<[tag] [type] class="item item_list lastset" data-type="[dataType]">[child]</[tag]>',this.HTMLChildList='<li contenteditable="true">[content]</li>',this.HTMLsticker='<div class="item item_sticker lastset" data-type="sticker">[el]</div>',this.HTMLQuote='<blockquote class="item item_quote lastset" data-type="quote"><p class="text" contenteditable="true"></p><p class="author" contenteditable="true"></p></blockquote>',this.HTMLTable='<div class="item item_table_area" data-type="table"><div class="scroll"><table class="item_table"><caption contenteditable="true"></caption><colgroup><col class="size_100"><col class="size_100"><col class="size_100"><col class="size_100"></colgroup><tbody><tr><th contenteditable="true" data-x="0" data-y="0"></th><th contenteditable="true" data-x="1" data-y="0"></th><th contenteditable="true" data-x="2" data-y="0"></th><th contenteditable="true" data-x="3" data-y="0"></th></tr><tr><td contenteditable="true" data-x="0" data-y="1"></td><td contenteditable="true" data-x="1" data-y="1"></td><td contenteditable="true" data-x="2" data-y="1"></td><td contenteditable="true" data-x="3" data-y="1"></td></tr></tbody></table></div><button class="btn btn_col_add">Add col</button><button class="btn btn_col_del">Remove col</button><button class="btn btn_row_add">Add row</button><button class="btn btn_row_del">Remove row</button></div>',this.HTMLCodeBlock='<pre class="item item_codeblock lastset" data-type="codeblock" data-theme="default" data-lang="text"><code class="nohighlight" contenteditable="true"></code></pre>',this.HTMLLinkBox='<div class="item lastset" data-type="link_box"><a href="[url]" target="_blank" rel="nofollow" class="link_box clearfix" draggable="false"><div class="img_area"><img src="[imgSrc]" alt="미리보기 이미지" class="img" draggable="false"></div><div class="text_area"><p class="link_title ellipsis">[title]</p><p class="link_description ellipsis">[description]</p><p class="link_domain">[domain]</p></div></a></div>',this.HTMLOption='<option value="[value]">[text]</option>',this.HTMLMediaRow='<li class="btn_add_media" data-webp="[webp]" data-idx="[idx]"><div class="img_area"><img src="[src]" alt="[alt]" width="[width]" data-height="[height]" class="img"></div><p class="name">[name]</p><button class="btn_remove_media" data-idx="[idx]">삭제</button></li>',this.HTMLImageType01='<picture class="item item_image lastset" data-type="image">[source]<img src="[src]" width="[width]" alt="[alt]" class="img"></picture>',this.HTMLImageSource='<source srcset="[webp]" type="image/webp">',this.HTMLImageType02='<div class="item item_image lastset" data-type="image"><img src="[src]" width="[width]" alt="[alt]" class="img"></div>',this.HTMLYoutube='<div class="item item_video lastset" data-type="youtube"><iframe src="[src]" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="video"></iframe></div>',this.HTMLCodepen='<div class="item item_codepen lastset" data-type="codepen"><iframe height="[height]" title="" src="[src]" allowfullscreen class="iframe"></iframe></div>',this.srcReg=new RegExp("(.*)\\.((jpg|png|gif|webp|bmp))","i"),this.youtubeReg=new RegExp("www.youtube.com","g"),this.youtubeCodeReg=new RegExp("((https:\\/\\/)?(www\\.)?youtu(be)?\\.(be|com)\\/(embed\\/|watch\\?v=)?)([^=\\/& :]*)(.*)","i"),this.codepenReg=new RegExp("codepen.io","g"),this.codepenCodeReg=new RegExp("(https:\\/\\/codepen\\.io\\/)(\\w*)\\/(pen|embed)\\/([A-Za-z]*)(.*)","i"),this.urlReg=new RegExp("https?:\\/\\/(\\w*:\\w*@)?[-\\w.]+(:\\d+)?(\\/([\\w\\/_.]*(\\?\\S+)?)?)?","i"),this.numberReg=new RegExp("[0-9]","g"),this.classReg={color:new RegExp("color_[a-z0-9_]*","i"),size:new RegExp("size_[0-9]*","i"),align:new RegExp("align_(left|center|right)*","i")},this.classList=["color","size","align"],this.messageNotSelecCodepen="string"!=typeof t.messageNotSelecCodepen?"You didn't select Codepen":t.messageNotSelecCodepen,this.messageNotSelecImage="string"!=typeof t.messageNotSelecImage?"You didn't select image":t.messageNotSelecImage,this.messageWrongURL="string"!=typeof t.messageWrongURL?"Please enter a valid URL.\nYou must enter http or https first.":t.messageWrongURL,this.messageNotSelect="string"!=typeof t.messageNotSelect?"No item selected Please try again.":t.messageNotSelect,this.messageNoData="string"!=typeof t.messageNoData?"Could not get data":t.messageNoData,this.messageExceedSize="string"!=typeof t.messageExceedSize?"Can't exceed [size]px":t.messageExceedSize,this.messageWrongNode="string"!=typeof t.messageWrongNode?"Wrong cursor pointer":t.messageWrongNode,this.messageNotAnchorTag="string"!=typeof t.messageNotAnchorTag?"Active item is not link":t.messageNotAnchorTag,this.messageWrongValue="string"!=typeof t.messageWrongValue?"Wrong value":t.messageWrongValue,this.messageWrongUrlType="string"!=typeof t.messageWrongUrlType?"Wrong URL type.":t.messageWrongUrlType,this.messageDelImage="string"!=typeof t.messageDelImage?"All images of the document you area creating will also disappear.\nAre you sure you want to delete it?":t.messageDelImage,this.messageDuplicateContent="string"!=typeof t.messageDuplicateContent?"This language not have content.\nDo you want duplicate to content?":t.messageDuplicateContent,this.messageRePasteCode="string"!=typeof t.messageRePasteCode?"This codeblock has other code.\nDo you want re-paste?":t.messageRePasteCode,this.messageNotSetAjax="Didn't setting Ajax url.",this.linkBoxData={},this.contentData={kr:[],en:[],es:[]},this.logData=[]}}},function(e,t,a){a(4),e.exports=a(6)},function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"init",(function(){return i})),a.d(t,"getOptionValue",(function(){return l})),a.d(t,"getContentData",(function(){return r})),a.d(t,"getStorage",(function(){return c})),a.d(t,"getActiveElement",(function(){return d})),a.d(t,"getEditableElement",(function(){return g})),a.d(t,"getItemElement",(function(){return u})),a.d(t,"setContentData",(function(){return p})),a.d(t,"setOptionValue",(function(){return m})),a.d(t,"addLanguage",(function(){return b})),a.d(t,"addContent",(function(){return h}));var s=a(2),n=a(0),o=a(1);function i(t,a={}){return t=null===t?".editor_area":t,e.storage=new s.a(t,a),""===storage.mediaUploadURL||""===storage.mediaUpdateURL||""===storage.mediaDelURL?void console.warn(storage.messageNotSetAjax):(storage.activeElement=storage.wrap,!0===storage.multiUpload&&storage.fileInput.setAttribute("multiple",!0),!0===storage.loading&&(storage.popBgArea.classList.remove("act"),storage.lodingArea.classList.remove("act")),Object(o.a)(),this)}function l(e){return void 0===storage[e]?(console.error(`Optins name "${e}" is didn't have.`),!1):storage[e]}function r(){let e=Object(o.b)();return storage.contentData[storage.langStatus]=e,storage.contentData}function c(){return storage}function d(){return storage.activeElement}function g(){return Object(n.b)(storage.activeElement)}function u(){return Object(n.c)(storage.activeElement,"item")}function p(e){storage.contentData=e,Object(o.c)(storage.contentData[storage.langStatus])}function m(e,t){return void 0===storage[e]?(console.error("Can not set other option name."),!1):(storage[e]=t,storage[e])}function b(e){return void 0===storage.contentData[e]?(storage.contentData[e]=[],!0):(console.error(`"${e}" is already exists.`),!1)}function h(e){let t=storage.contentArea.childElementCount,a=Object(n.d)(".lastset");(null===a?storage.contentArea.children[t-1]:a).insertAdjacentHTML("afterend",e)}e.typeCheck=(e,t)=>{if("string"==typeof t){if(typeof e!=t)throw`invaild type ${e} : ${t}`}else if(!(e instanceof t))throw`invaild type ${e} : ${t}`;return e}}.call(this,a(5))},function(e,t){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){}])}));