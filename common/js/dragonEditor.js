!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.dragonEditor=t():e.dragonEditor=t()}(window,(function(){return function(e){var t={};function s(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);s.d(t,"default",(function(){return a}));class a{constructor(e=".editor_area",t={}){this.setting(e,t),this.bindingEvent(),this.closeLoding()}setting(e,t){this.startTextCursor=0,this.endTextCursor=0,this.activeElement,this.focusNode,this.baseNode,this.langStatus="ko",this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.changePint="number"!=typeof t.changePint?1120:t.changePint,this.maxImageWidth="number"!=typeof t.maxImageWidth?800:t.maxImageWidth,this.maxCodepenHeight="number"!=typeof t.maxCodepenHeight?1e3:t.maxCodepenHeight,this.clickCehck=!1,this.useWebp=!0,this.codepenTheme="string"!=typeof t.codepenTheme?"dark":t.codepenTheme,this.multiUpload="boolean"==typeof t.multiUpload&&t.multiUpload,this.mediaUploadURL="string"!=typeof t.mediaUploadURL?"":t.mediaUploadURL,this.mediaUpdateURL="string"!=typeof t.mediaUpdateURL?"":t.mediaUpdateURL,this.mediaDelURL="string"!=typeof t.mediaDelURL?"":t.mediaDelURL,this.makeLinkBoxType="self"!=typeof t.makeLinkBoxType?"self":"api",this.makeLinkBoxURL="string"!=typeof t.makeLinkBoxURL?"":t.makeLinkBoxURL,this.imageIconId="string"!=typeof t.imageIconId?"#icon_image":t.imageIconId,this.youtubeIconId="string"!=typeof t.youtubeIconId?"#icon_youtube":t.youtubeIconId,this.codepenIconId="string"!=typeof t.codepenIconId?"#icon_codepen":t.codepenIconId,this.contentAreaName="string"!=typeof t.contentArea?".content_area":t.contentArea,this.popOptionsName="string"!=typeof t.popOptions?".pop_options":t.popOptions,this.popLinkName="string"!=typeof t.popLink?".pop_link_box":t.popLink,this.stickerListName="string"!=typeof t.stickerList?".pop_sticker":t.stickerList,this.contentAddListName="string"!=typeof t.contentAddList?".pop_content_list":t.contentAddList,this.wrap=this.checkOptionElement(e,".editor_area"),this.editorSection=this.checkOptionElement(t.editorSection,".editor_section"),this.contentArea=this.checkOptionElement(t.contentArea,".content_area"),this.contentAddList=this.checkOptionElement(t.contentAddList,".pop_content_list"),this.mediaList=this.checkOptionElement(t.mediaList,".pop_media .media_list"),this.popMedia=this.checkOptionElement(t.popMedia,".pop_media"),this.popLang=this.checkOptionElement(t.popLang,".pop_lang"),this.popBgArea=this.checkOptionElement(t.popBgArea,".pop_bg"),this.popOptions=this.checkOptionElement(t.popOptions,".pop_options"),this.popLink=this.checkOptionElement(t.popLink,".pop_link_box"),this.lodingArea=this.checkOptionElement(t.lodingArea,".pop_loding"),this.fileInput=this.checkOptionElement(t.fileInput,".file_check"),this.uploadForm=this.checkOptionElement(t.uploadForm,".file_uploader"),this.contentAddBtn=this.checkOptionElement(t.contentAddBtn,".btn_add_content","multi"),this.viewBtn=this.checkOptionElement(t.viewBtn,".btn_mod"),this.popBtns=this.checkOptionElement(t.popBtn,".btn_pop","multi"),this.popCloseBtns=this.checkOptionElement(t.popCloseBtns,".btn_pop_close","multi"),this.fontSizeSelect=this.checkOptionElement(t.fontSizeSelect,".select_font_size"),this.btnColorSelect=this.checkOptionElement(t.colorSelect,".select_color"),this.btnColor=this.checkOptionElement(t.colorSelect,".btn_set_color","multi"),this.textAlgin=this.checkOptionElement(t.textAlgin,".btn_text_algin","multi"),this.listTypeSelect=this.checkOptionElement(t.listTypeSelect,".select_list_type"),this.colSizeSelect=this.checkOptionElement(t.colSizeSelect,".select_col"),this.themeSelect=this.checkOptionElement(t.themeSelect,".select_theme"),this.languageSelect=this.checkOptionElement(t.languageSelect,".select_language"),this.changeThBtn=this.checkOptionElement(t.changeThBtn,".btn_change_th"),this.changeTdBtn=this.checkOptionElement(t.changeTdBtn,".btn_change_td"),this.widthInput=this.checkOptionElement(t.widthInput,".options_width .value"),this.heightInput=this.checkOptionElement(t.heightInput,".options_height .value"),this.urlInput=this.checkOptionElement(t.urlInput,".options_url .value"),this.changeUrlBtn=this.checkOptionElement(t.changeUrlBtn,".btn_url_change"),this.addLinkBtn=this.checkOptionElement(t.addLinkBtn,".btn_url_link"),this.unlinkBtn=this.checkOptionElement(t.unlinkBtn,".btn_url_unlink"),this.boldBtn=this.checkOptionElement(t.boldBtn,".btn_bold"),this.italicBtn=this.checkOptionElement(t.italicBtn,".btn_italic"),this.underlineBtn=this.checkOptionElement(t.underlineBtn,".btn_underline"),this.strikeBtn=this.checkOptionElement(t.strikeBtn,".btn_strike"),this.wordblockBtn=this.checkOptionElement(t.wordblockBtn,".btn_wordblock"),this.contentDelBtn=this.checkOptionElement(t.contentDelBtn,".btn_del_content"),this.languageChangeBtn=this.checkOptionElement(t.languageChangeBtn,".btn_chang_lang","multi"),this.HTMLTextBlock='<p class="item item_text lastset" contenteditable="true" data-type="text">[content]</p>',this.HTMLBtn='<div class="btn lastset" data-type="btn" data-value="[type]"><svg viewbox="0 0 50 50" class="icon"><use class="path" xlink:href="[icon_id]" href="[icon_id]" /></svg>[text]</div>',this.HTMLList='<[tag] [type] class="item item_list lastset" data-type="[dataType]">[child]</[tag]>',this.HTMLChildList='<li contenteditable="true">[content]</li>',this.HTMLsticker='<div class="item item_sticker lastset" data-type="sticker">[el]</div>',this.HTMLQuote='<blockquote class="item item_quote lastset" data-type="quote"><p class="text" contenteditable="true"></p><p class="author" contenteditable="true"></p></blockquote>',this.HTMLTable='<div class="item item_table_area" data-type="table"><div class="scroll"><table class="item_table"><caption contenteditable="true"></caption><colgroup><col class="size_100"><col class="size_100"><col class="size_100"><col class="size_100"></colgroup><tbody><tr><th contenteditable="true" data-x="0" data-y="0"></th><th contenteditable="true" data-x="1" data-y="0"></th><th contenteditable="true" data-x="2" data-y="0"></th><th contenteditable="true" data-x="3" data-y="0"></th></tr><tr><td contenteditable="true" data-x="0" data-y="1"></td><td contenteditable="true" data-x="1" data-y="1"></td><td contenteditable="true" data-x="2" data-y="1"></td><td contenteditable="true" data-x="3" data-y="1"></td></tr></tbody></table></div><button class="btn btn_col_add">Add col</button><button class="btn btn_col_del">Remove col</button><button class="btn btn_row_add">Add row</button><button class="btn btn_row_del">Remove row</button></div>',this.HTMLCodeBlock='<pre class="item item_codeblock lastset" data-type="codeblock" data-theme="default" data-lang="text"><code class="nohighlight" contenteditable="true"></code></pre>',this.HTMLLinkBox='<div class="item lastset" data-type="link_box"><a href="[url]" target="_blank" rel="nofollow" class="link_box clearfix" draggable="false"><div class="img_area"><img src="[imgSrc]" alt="미리보기 이미지" class="img" draggable="false"></div><div class="text_area"><p class="link_title ellipsis">[title]</p><p class="link_description ellipsis">[description]</p><p class="link_domain">[domain]</p></div></a></div>',this.HTMLOption='<option value="[value]">[text]</option>',this.HTMLMediaRow='<li class="btn_add_media" data-webp="[webp]" data-idx="[idx]"><div class="img_area"><img src="[src]" alt="[alt]" width="[width]" data-height="[height]" class="img"></div><p class="name">[name]</p><button class="btn_remove_media" data-idx="[idx]">삭제</button></li>',this.HTMLImageType01='<picture class="item item_image lastset" data-type="image">[source]<img src="[src]" width="[width]" alt="[alt]" class="img"></picture>',this.HTMLImageSource='<source srcset="[webp]" type="image/webp">',this.HTMLImageType02='<div class="item item_image lastset" data-type="image"><img src="[src]" width="[width]" alt="[alt]" class="img"></div>',this.HTMLYoutube='<div class="item item_video lastset" data-type="youtube"><iframe src="[src]" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="video"></iframe></div>',this.HTMLCodepen='<div class="item item_codepen lastset" data-type="codepen"><iframe height="[height]" title="" src="[src]" allowfullscreen class="iframe"></iframe></div>',this.srcReg=new RegExp("(.*)\\.((jpg|png|gif|webp|bmp))","i"),this.youtubeReg=new RegExp("www.youtube.com","g"),this.youtubeCodeReg=new RegExp("((https:\\/\\/)?(www\\.)?youtu(be)?\\.(be|com)\\/(embed\\/|watch\\?v=)?)([^=\\/& :]*)(.*)","i"),this.codepenReg=new RegExp("codepen.io","g"),this.codepenCodeReg=new RegExp("(https:\\/\\/codepen\\.io\\/)(\\w*)\\/(pen|embed)\\/([A-Za-z]*)(.*)","i"),this.urlReg=new RegExp("https?:\\/\\/(\\w*:\\w*@)?[-\\w.]+(:\\d+)?(\\/([\\w\\/_.]*(\\?\\S+)?)?)?","i"),this.numberReg=new RegExp("[0-9]","g"),this.classReg={color:new RegExp("color_[a-z0-9_]*","i"),size:new RegExp("size_[0-9]*","i"),align:new RegExp("align_(left|center|right)*","i")},this.classList=["color","size","align"],this.messageNotSelecCodepen="string"!=typeof t.messageNotSelecCodepen?"You didn't select Codepen":t.messageNotSelecCodepen,this.messageNotSelecImage="string"!=typeof t.messageNotSelecImage?"You didn't select image":t.messageNotSelecImage,this.messageWrongURL="string"!=typeof t.messageWrongURL?"Please enter a valid URL.\nYou must enter http or https first.":t.messageWrongURL,this.messageNotSelect="string"!=typeof t.messageNotSelect?"No item selected Please try again.":t.messageNotSelect,this.messageNoData="string"!=typeof t.messageNoData?"Could not get data":t.messageNoData,this.messageExceedSize="string"!=typeof t.messageExceedSize?"Can't exceed [size]px":t.messageExceedSize,this.messageWrongNode="string"!=typeof t.messageWrongNode?"Wrong cursor pointer":t.messageWrongNode,this.messageNotAnchorTag="string"!=typeof t.messageNotAnchorTag?"Active item is not link":t.messageNotAnchorTag,this.messageWrongValue="string"!=typeof t.messageWrongValue?"Wrong value":t.messageWrongValue,this.messageWrongUrlType="string"!=typeof t.messageWrongUrlType?"Wrong URL type.":t.messageWrongUrlType,this.messageDelImage="string"!=typeof t.messageDelImage?"All images of the document you area creating will also disappear.\nAre you sure you want to delete it?":t.messageDelImage,this.messageDuplicateContent="string"!=typeof t.messageDuplicateContent?"This language not have content.\nDo you want duplicate to content?":t.messageDuplicateContent,this.messageNotSetAjax="Didn't setting Ajax url.",this.linkBoxData={},this.contentData={ko:{},en:{},es:{}},this.logData=[]}bindingEvent(){let e,t=this;if(""===t.mediaUploadURL||""===t.mediaUpdateURL||""===t.mediaDelURL)return void console.warn(t.messageNotSetAjax);t.activeElement=t.wrap,t.windowWidth>t.changePint?t.contentAddList.classList.add("act"):t.windowWidth<t.changePint&&t.contentAddList.classList.remove("act"),!0===t.multiUpload&&t.fileInput.setAttribute("multiple",!0),window.addEventListener("resize",(function(){clearTimeout(e),e=setTimeout(()=>{t.windowWidth=window.innerWidth,t.windowHeight=window.innerHeight,t.windowWidth>t.changePint?t.contentAddList.classList.add("act"):t.windowWidth<t.changePint&&t.contentAddList.classList.remove("act")},250)})),document.addEventListener("contextmenu",(function(e){e.preventDefault()})),document.addEventListener("mouseup",(function(e){if("object"==typeof e){let s=e.target;if(0===e.button){let e=t.findParent(s,"pop"),a=t.findParent(s,"btn_pop");t.getElList(".pop").forEach((function(e){if(!1===a)e.classList.remove("act");else{let s=a.dataset.target;e!==t.getEl(s)&&e.classList.remove("act")}t.windowWidth>t.changePint&&t.contentAddList.classList.add("act")})),t.popBtns.forEach((function(e){a===e||e.classList.contains("select_color")||e.classList.remove("act")})),!1!==e&&e.classList.add("act")}}})),document.addEventListener("keydown",(function(e){if("HTMLBodyElement"===document.activeElement.constructor.name){let s;!0!==e.ctrlKey&&!0!==e.metaKey||(s=!0),"z"===e.key&&(!0===s?(e.preventDefault(),t.actionPrev()):!0===s&&!0===e.shiftKey&&(e.preventDefault(),t.actionNext()))}})),document.addEventListener("paste",(function(e){console.log("paste",e)})),document.addEventListener("copy",(function(e){console.log("copy",e)})),window.addEventListener("scroll",(function(e){}));let s,a;t.contentArea.addEventListener("click",(function(e){clearTimeout(s),s=setTimeout(()=>{0!==e.button&&!1!==e.isTrusted||(t.contentCheckByMouse(e.target,"click"),t.checkOptionsValue(e.target),t.tableConstrol(e.target))},150)})),t.contentArea.addEventListener("mouseover",(function(e){clearTimeout(a),a=setTimeout(()=>{t.windowWidth>t.changePint&&(t.contentCheckByMouse(e.target,"mouseover"),t.checkOptionsValue(e.target))},250)})),t.contentArea.addEventListener("keydown",(function(e){t.keybroadControl(e)})),t.contentAddBtn.forEach((function(e){e.addEventListener("click",(function(){let e=this.dataset.value,s=t.contentArea.childElementCount,a=t.getEl(".lastset"),n=!1===a?t.contentArea.children[s-1]:a;switch(e){case"text":t.addTextBlock(n);break;case"image":t.addBtn(n,t.imageIconId,"image","Add on image"),t.fileInput.dataset.type="image",t.fileInput.setAttribute("accept","image/*"),t.fileInput.click();break;case"sticker":t.addSticker(n,this);break;case"youtube":t.addBtn(n,t.youtubeIconId,"youtube","Add Youtube");break;case"codepen":t.addBtn(n,t.codepenIconId,"codepen","Add Codepen");break;case"bulletedlist":t.addList(n,"ul");break;case"numberedlist":t.addList(n,"ol","1");break;case"quote":t.addQuote(n);break;case"table":t.addTable(n);break;case"codeblock":t.addCodeBlock(n);break;case"link":t.addLinkBox(n,t.linkBoxData),t.popLink.classList.remove("act"),t.popLink.querySelector(".url").value="",t.popLink.querySelector(".view").innerHTML="",t.popLink.querySelector(".btn_submit").setAttribute("disabled","true")}}))})),t.viewBtn.addEventListener("click",(function(){t.editorSection.classList.toggle("mobile"),this.classList.toggle("act")})),t.popBtns.forEach((function(e){e.addEventListener("click",(function(){let e=this.dataset.target,s=this.dataset.type,a=t.getEl(e),n=this.getBoundingClientRect(),i=t.popOptions.getBoundingClientRect();if(a.removeAttribute("style"),a.classList.toggle("act"),"position"===s&&t.windowWidth>t.changePint){let e=Math.floor(n.left-i.left);a.style.cssText=`transform:translate(${e}px, 30px)`}else this.classList.toggle("act")}))})),t.popCloseBtns.forEach((function(e){e.addEventListener("click",(function(){let e=this.dataset.target,s=t.getEl(e);s.removeAttribute("style"),s.classList.toggle("act")}))}));let n=t.getEl(t.popLinkName+" .btn_check");!1!==n?n.addEventListener("click",(function(){let e={},s=t.getEl(t.popLinkName+" .view"),a=t.getEl(t.popLinkName+" .btn_submit"),n=t.getEl(t.popLinkName+" .url").value;!0===t.urlReg.test(n)?(e.url=n,fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(n)}`).then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok.")}).then(i=>{let l=i.contents;if(null!==l){let i=new RegExp('property=\\"og:title\\"',"g"),o=new RegExp('([^])*\\<title>([^"]*)<\\/title>([^]*)',"g"),c=new RegExp('([^])*\\<meta property=\\"og:title\\" content=\\"([^"]*)"\\>([^]*)',"g"),r=new RegExp('property=\\"og:image\\"',"g"),d=new RegExp('([^])*\\<meta name=\\"image\\" content=\\"([^"]*)"\\>([^]*)',"g"),u=new RegExp('([^])*\\<meta property=\\"og:image\\" content=\\"([^"]*)"\\>([^]*)',"g"),p=new RegExp('property=\\"og:description\\"',"g"),h=new RegExp('([^])*\\<meta name=\\"description\\" content=\\"([^"]*)"\\>([^]*)',"g"),g=new RegExp('([^])*\\<meta property=\\"og:description\\" content=\\"([^"]*)"\\>([^]*)',"g");if(i.test(l)?e.title=l.replace(c,"$2"):e.title=l.replace(o,"$2"),r.test(l))e.img=l.replace(u,"$2");else{let t=l.replace(d,"$2");t.length>500?e.img="":e.img=t}if(p.test(l))e.description=l.replace(g,"$2");else{let t=l.replace(h,"$2");t.length>500?e.description="":e.description=t}n.indexOf("://")>-1?e.domain=n.split("/")[2]:e.domain=n.split("/")[0],e.domain=e.domain.split(":")[0],t.linkBoxData=e,a.removeAttribute("disabled"),t.addLinkBox(s,e,"afterbegin")}else a.setAttribute("disabled","true"),s.innerHTML=t.messageNoData})):alert(t.messageWrongURL)})):console.warn("We need link check button from "+t.popLinkName),t.contentDelBtn.addEventListener("click",(function(){let e=t.getEl(".lastset");if(null!==e){e.remove(),t.popOptions.classList.remove("act"),1===t.contentArea.childElementCount&&t.addTextBlock(t.contentArea,"","beforeend")}else alert(t.messageNotSelect)})),t.fontSizeSelect.addEventListener("change",(function(){let e=this.value,s=t.activeElement,a=t.findContenteditable(s),n=t.getClassName(a.classList.value,"size");"default"===e?""!==n&&a.classList.remove(n):(""!==n&&a.classList.remove(n),a.classList.add(e))})),t.btnColor.forEach((function(e){e.addEventListener("click",(function(){let e=this.dataset.class,s=["I","B","S","U","A","SPAN"],a=t.activeElement,n=a.tagName,i=t.findContenteditable(a);if(window.getSelection().focusNode===window.getSelection().baseNode)if(s.indexOf(n)>0){let s=t.getClassName(a.classList.value,"color");if(""!==s&&a.classList.remove(s),"default"!==e)a.classList.add(e);else if("SPAN"===n){let e=a.textContent;a.insertAdjacentText("afterend",e),a.remove(),i.innerHTML=i.innerHTML,t.activeElement=t.wrap}t.btnColorSelect.dataset.class=e}else{let s=t.getClassName(i.classList.value,"color");t.startTextCursor===t.endTextCursor?(""!==s&&i.classList.remove(s),"default"!==e&&i.classList.add(e),t.btnColorSelect.dataset.class=e):t.wrapElement("color",null,e)}else alert(t.messageWrongNode)}))})),t.addLinkBtn.addEventListener("click",(function(){let e=t.urlInput.value;if(!0===t.urlReg.test(e)){!0===t.checkSameNode()?t.wrapElement("link",e):alert(t.messageWrongNode)}else alert(t.messageWrongURL)})),t.unlinkBtn.addEventListener("click",(function(){let e=t.activeElement,s=t.findContenteditable(e);if("HTMLAnchorElement"===e.constructor.name){let t=e.textContent;e.insertAdjacentText("afterend",t),e.remove(),s.innerHTML=s.innerHTML}else alrt(t.messageNotAnchorTag)})),t.boldBtn.addEventListener("click",(function(){t.makeTextDecoration("b","B","bold")})),t.italicBtn.addEventListener("click",(function(){t.makeTextDecoration("i","I","italic")})),t.underlineBtn.addEventListener("click",(function(){t.makeTextDecoration("u","U","underline")})),t.strikeBtn.addEventListener("click",(function(){t.makeTextDecoration("s","S","strike")})),t.wordblockBtn.addEventListener("click",(function(){if(window.getSelection().focusNode===window.getSelection().baseNode){let e=t.activeElement,s=e.tagName,a=t.findContenteditable(e),n=e.textContent;"CODE"===s?(e.insertAdjacentText("afterend",n),e.remove(),a.innerHTML=a.innerHTML,t.activeElement=t.wrap):t.wrapElement("wordblock")}else alert(t.messageWrongNode)})),t.widthInput.addEventListener("keyup",(function(e){if("Enter"===e.key){let e=this.value,s=t.getEl(".lastset .img"),a=t.messageExceedSize.replace("[size]",t.maxImageWidth);if(!1!==s)if(t.numberReg.test(e)){e<=t.maxImageWidth?s.setAttribute("width",e):(alert(a),this.value=t.maxImageWidth,s.setAttribute("width",t.maxImageWidth));let n=t.getEl(".lastset").getBoundingClientRect();t.openOptionPop(n,"img")}else alert(t.messageWrongValue);else alert(t.messageNotSelecImage)}})),t.heightInput.addEventListener("keyup",(function(e){if("Enter"===e.key){let e=this.value,s=t.getEl(".lastset .iframe"),a=t.messageExceedSize.replace("[size]",t.maxCodepenHeight);if(!1!==s)if(t.numberReg.test(e)){e<=t.maxCodepenHeight?s.setAttribute("height",e):(alert(a),this.value=t.maxCodepenHeight,s.setAttribute("height",t.maxCodepenHeight));let n=t.getEl(".lastset").getBoundingClientRect();t.openOptionPop(n,"codepen")}else alert(t.messageWrongValue);else alert(t.messageNotSelecCodepen)}})),t.listTypeSelect.addEventListener("change",(function(){let e=this.value,s=t.getEl(".lastset");!1!==s&&s.setAttribute("type",e)})),t.colSizeSelect.addEventListener("change",(function(){let e=this.value,s=t.activeElement.constructor.name,a=t.getEl(".lastset");if(("HTMLTableCellElement"===s||"HTMLTableCaptionElement"===s)&&!1!==a){let s=parseInt(t.activeElement.dataset.x)+1,n=a.querySelector(`col:nth-child(${s})`),i=t.getClassName(n.classList.value,"size");n.classList.remove(i),n.classList.add(e)}})),t.themeSelect.addEventListener("change",(function(){let e=this.value,s=t.getEl(".lastset");!1!==s&&(s.dataset.theme=e)})),t.languageSelect.addEventListener("change",(function(){let e=this.value,s=t.getEl(".lastset");if(!1!==s){let t=s.childNodes[0];s.dataset.lang=e,t.classList.value="",t.classList.add(e),hljs.highlightBlock(t)}})),t.changeThBtn.addEventListener("click",(function(){t.changeCell("th")})),t.changeTdBtn.addEventListener("click",(function(){t.changeCell("td")})),t.textAlgin.forEach((function(e){e.addEventListener("click",(function(){let e=this.dataset.value,s=!1===t.findContenteditable(t.activeElement)?t.findParent(t.activeElement,"item"):t.findContenteditable(t.activeElement),a=t.getClassName(s.classList.value,"align");""!==a&&s.classList.remove(a),s.classList.add(e)}))})),t.changeUrlBtn.addEventListener("click",(function(){let e=t.urlInput.value,s=t.getEl(".lastset"),a=s.dataset.type;switch(!0){case!1===t.urlReg.test(e):alert(t.messageWrongURL);break;case void 0===s:alert(t.messageNotSelect);break;case"youtube"===a:if(t.youtubeReg.test(e)){s.querySelector(".video").setAttribute("src",e)}else alert(t.messageWrongUrlType);break;case"codepen"===a:if(t.codepenReg.test(e)){s.querySelector(".iframe").setAttribute("src",e)}else alert(t.messageWrongUrlType);break;case"btn"===a:let n=s.dataset.value;"youtube"===n?(t.addYoutube(s,e),s.remove(),t.activeElement=t.contentArea):"codepen"===n&&(t.addCodepen(s,e),s.remove(),t.activeElement=t.contentArea)}})),t.fileInput.addEventListener("change",(function(){let e=t.contentArea,s=this.files,a=new FormData,n=this.dataset.type,i=e.dataset.idx,l=e.dataset.tempIdx;a.append("request_ype","upload"),a.append("file_type",n);for(let e of s)a.append("file[]",e);a.append("article_idx",i),a.append("temp_idx",l),t.ajax("post",t.mediaUploadURL,a,"form",e=>{if(!0===e.result){let s=!1===t.getEl(".lastset")?t.getEl(`${t.contentAreaName} > *:nth-last-child(1)`):t.getEl(".lastset"),a=e.list,n="";for(let e of a){let a="y"===e.webp;n+=t.HTMLMediaRow.replace(/\[idx\]/g,e.idx).replace("[webp]",a).replace("[height]",e.height).replace("[width]",e.width).replace("[src]",`${e.src}${e.name}.${e.format}`).replace("[alt]",e.alt).replace("[name]",e.alt),t.addImage(s,{idx:e.idx,src:`${e.src}${e.name}`,webp:a,format:e.format,alt:e.alt,width:e.width,height:e.height})}s.classList.contains("btn")&&s.remove(),t.mediaList.insertAdjacentHTML("beforeend",n),t.popMedia.classList.add("act"),this.value=""}else alert(e.message)})})),t.popMedia.addEventListener("click",(function(e){let s,a=e.target,n=t.findParent(a,"btn_add_media"),i=this.querySelector("*[contenteditable]");switch(a.tagName){case"IMG":let e=a.getAttribute("src"),l=!1===t.getEl(".lastset")?t.getEl(`${t.contentAreaName} > *:nth-last-child(1)`):t.getEl(".lastset");s={width:a.getAttribute("width"),height:a.dataset.height,webp:n.dataset.webp,alt:n.querySelector(".name").textContent,src:e.replace(t.srcReg,"$1"),format:e.replace(t.srcReg,"$2")},t.addImage(l,s);break;case"P":null!==i&&(n=t.findParent(i,"btn_add_media"),i.removeAttribute("contenteditable"),s={idx:n.dataset.idx,textContent:i.textContent},t.ajax("post",t.mediaUpdateURL,s,"json",(function(e){if(!0===e.result){let e=n.querySelector(".img").getAttribute("src");t.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.setAttribute("alt",i.textContent)}))}else alert(e.message)}))),a.setAttribute("contenteditable",!0),a.focus();break;case"BUTTON":let o=n.dataset.idx;!0===confirm(t.messageDelImage)&&t.ajax("delete",`${t.mediaDelURL}/${o}`,[],"form",(function(e){if(!0===e.result){let e=n.querySelector(".img").getAttribute("src");t.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.remove(),n.remove()}))}else alert(e.message)}));break;default:null!==i&&(n=t.findParent(i,"btn_add_media"),s={idx:n.dataset.idx,textContent:i.textContent},i.removeAttribute("contenteditable"),t.ajax("post",t.mediaUpdateURL,s,"json",(function(e){if(!0===e.result){let e=n.querySelector(".img").getAttribute("src");t.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.setAttribute("alt",i.textContent)}))}else alert(e.message)})))}})),t.popMedia.addEventListener("keydown",(function(e){if("Enter"===e.key){e.preventDefault();let s=t.findParent(e.target,"btn_add_media"),a=e.target.textContent,n={idx:s.dataset.idx,textContent:a};t.ajax("post",t.mediaUpdateURL,n,"json",(function(e){if(!0===e.result){let e=s.querySelector(".img").getAttribute("src");t.contentArea.querySelectorAll(`*[src="${e}"]`).forEach((function(e){e.setAttribute("alt",$p.textContent)}))}else alert(e.message)})),e.target.removeAttribute("contenteditable")}})),t.languageChangeBtn.forEach((function(e){e.addEventListener("click",(function(){let e=t.langStatus,s=t.getJsonData(),a=this.dataset.value,n=t.contentData[a];if(t.langStatus=a,t.languageChangeBtn.forEach((function(e){e.classList.remove("act")})),this.classList.add("act"),n.length>0)t.setContent(n);else{!0===confirm(t.messageDuplicateContent)?t.setContent(s[e]):t.setContent([{type:"title",class:["title"],textContent:""},{type:"text",class:["item"],textContent:""}])}}))}))}changeCell(e){let t=this.activeElement;if(t.tagName!==e.toUpperCase()){let s=t.dataset.x,a=t.dataset.y;t.insertAdjacentHTML("afterend",`<${e} contenteditable="true" data-x="${s}" data-y="${a}"></${e}>`),this.activeElement=t.nextElementSibling,t.nextElementSibling.focus(),t.remove()}}checkOptionElement(e,t,s="single"){let a;if(a="single"===s?"string"!=typeof e?this.getEl(t):this.getEl(e):"string"!=typeof e?this.getElList(t):this.getElList(e),!1!==a)return a;console.error("Can not find Element : "+e)}getEl(e){let t=document.querySelector(e);return null!==t&&t}getElList(e){let t=document.querySelectorAll(e);return!(t.length<1)&&t}findParent(e,t){if("HTMLBodyElement"!==e.constructor.name&&"HTMLHtmlElement"!==e.constructor.name){return!0===e.classList.contains(t)?e:this.findParent(e.parentElement,t)}return!1}findContenteditable(e){let t,s=e.constructor.name;if("HTMLBodyElement"!==s){return t="Text"===s?e.parentElement:e,"true"===t.getAttribute("contenteditable")?t:this.findContenteditable(t.parentElement)}return!1}closeLoding(){this.popBgArea.classList.remove("act"),this.lodingArea.classList.remove("act")}removeLastsetClass(e){!0===e.classList.contains("lastset")&&e.classList.remove("lastset")}addTextBlock(e,t="",s="afterend"){this.removeLastsetClass(e);let a=this.HTMLTextBlock.replace("[content]",t);e.insertAdjacentHTML(s,a),e.nextElementSibling.focus()}addBtn(e,t,s,a){this.removeLastsetClass(e);let n=this.HTMLBtn.replace(/\[icon_id\]/g,t).replace(/\[type\]/g,s).replace(/\[text\]/g,a);e.insertAdjacentHTML("afterend",n)}addSticker(e,t){this.removeLastsetClass(e);let s=this.HTMLsticker.replace("[el]",t.innerHTML);e.insertAdjacentHTML("afterend",s)}addList(e,t,s=null,a=""){let n;this.removeLastsetClass(e),n="ol"===t?"list_o":"list_u";let i=null===s?"":'type="'+s+'"',l=this.HTMLChildList.replace(/\[content\]/g,a),o=this.HTMLList.replace(/\[tag\]/g,t).replace("[dataType]",n).replace("[type]",i).replace("[child]",l);e.insertAdjacentHTML("afterend",o),e.nextElementSibling.children[0].focus()}addQuote(e){this.removeLastsetClass(e),e.insertAdjacentHTML("afterend",this.HTMLQuote),e.nextElementSibling.children[0].focus()}addTable(e){this.removeLastsetClass(e),e.insertAdjacentHTML("afterend",this.HTMLTable),e.nextElementSibling.querySelector("caption").focus()}addCodeBlock(e){this.removeLastsetClass(e),e.insertAdjacentHTML("afterend",this.HTMLCodeBlock),e.nextElementSibling.children[0].focus()}addLinkBox(e,t,s="afterend"){this.removeLastsetClass(e),""===t.img&&(t.img="./common/img/img_cover.png");let a=this.HTMLLinkBox.replace("[url]",t.url).replace("[imgSrc]",t.img).replace("[title]",t.title).replace("[description]",t.description).replace("[domain]",t.domain);e.insertAdjacentHTML(s,a)}addImage(e,t,s="afterend"){let a,n;if(this.removeLastsetClass(e),n=100/t.width*t.height>100?300:t.width,n>this.maxImageWidth&&(n=this.maxImageWidth),!0===this.useWebp==1)if(a=this.HTMLImageType01.replace("[src]",`${t.src}.${t.format}`).replace("[alt]",t.alt).replace("[width]",n),!0===t.webp){let e=this.HTMLImageSource.replace("[webp]",`${t.src}.webp`);a=a.replace("[source]",e)}else a=a.replace("[source]","");else a=this.HTMLImageType02.replace("[src]",`${t.src}.${t.format}`).replace("[alt]",t.alt).replace("[width]",n);e.insertAdjacentHTML(s,a)}addYoutube(e,t,s="afterend"){this.removeLastsetClass(e);let a=t.replace(this.youtubeCodeReg,"$7"),n=this.HTMLYoutube.replace("[src]",`https://www.youtube.com/embed/${a}`);e.insertAdjacentHTML(s,n)}addCodepen(e,t,s="afterend",a=300){this.removeLastsetClass(e);let n=t.replace(this.codepenCodeReg,"$2"),i=t.replace(this.codepenCodeReg,"$4"),l=this.HTMLCodepen.replace("[src]",`https://codepen.io/${n}/embed/${i}?height=${a}&theme-id=${this.codepenTheme}&default-tab=result`).replace("[height]",a);e.insertAdjacentHTML(s,l)}getLastSetOrFocus(e){let t,s=!1;if("HTMLBodyElement"!==document.activeElement.constructor.name)switch(this.activeElement.constructor.name){case"HTMLSpanElement":case"HTMLElement":case"HTMLAnchorElement":t=this.activeElement;break;case"Text":t=this.findParent(this.activeElement.parentElement,"item");break;default:t=this.findParent(this.activeElement,"item")}else t=this.findParent(e,"item"),s=!1===t?this.findParent(e,"btn"):t;return!1===t?s:t}setLastElement(e,t){let s=!1===this.findParent(e,"item")?this.findParent(e,"btn"):this.findParent(e,"item");t.forEach((function(e){e.classList.remove("lastset")})),s.classList.add("lastset")}openOptionPop(e,t){let s=Math.floor(e.top+e.height),a=this.popOptions.querySelectorAll(".col"),n=new RegExp(t,"i");null!==a&&a.forEach((function(e){let t=e.dataset.group;switch(!0){case"all"===t:case!0===n.test(t):e.classList.add("act");break;case!1===n.test(t):e.classList.remove("act")}})),this.popOptions.classList.add("act"),this.popOptions.querySelector(".pop").classList.remove("act");let i=Math.floor((this.windowWidth-this.popOptions.getBoundingClientRect().width)/2);this.windowWidth>this.changePint?this.popOptions.style.cssText="transform:translate("+i+"px, "+s+"px)":this.popOptions.removeAttribute("style")}contentCheckByMouse(e,t){"click"===t&&(this.activeElement=e);let s=this.getLastSetOrFocus(e),a=window.getSelection().baseOffset,n=window.getSelection().extentOffset;if(!1!==s){let e=s.getBoundingClientRect(),i=s.dataset.type,l=this.getElList(this.contentAreaName+" > *"),o=s.classList.contains("btn");switch(!0){case"CODE"===s.tagName&&"PRE"===s.parentElement.tagName:i="codeblock";break;case"HTMLElement"===s.constructor.name&&s.classList.contains("wordblock"):i="wordblock";break;case"HTMLAnchorElement"===s.constructor.name:i="link";break;case!0===o&&"click"===t:if(void 0!==s.dataset.value){let e=s.dataset.value;"image"===e?(this.fileInput.dataset.type="image",this.fileInput.setAttribute("accept","image/*"),this.fileInput.click()):i=e}break;case window.getSelection().focusNode!==window.getSelection().baseNode:i="text";break;case a!==n:"BLOCKQUOTE"!==s.tagName&&(this.focusNode=window.getSelection().focusNode,this.baseNode=window.getSelection().baseNode,this.startTextCursor=a,this.endTextCursor=n,i="word");break;case void 0===i:i="all";break;default:i=i}"click"===t?(this.setLastElement(s,l),this.openOptionPop(e,i)):"mouseover"!==t||"youtube"!==i&&"codepen"!==i||(this.setLastElement(s,l),this.openOptionPop(e,i))}}checkOptionsValue(e){let t=this.findParent(e,"item");t=!1===t?this.findParent(e,"btn"):t;let s=this.activeElement;if(!1!==t){let e=t.dataset.type,a=s.constructor.name,n=t.classList.value,i=s.classList.value;switch(this.urlInput.value="",e){case"text":let e=this.getClassName(n,"color"),s=this.getClassName(n,"size");this.btnColorSelect.dataset.class=""!==e?e:"default",this.fontSizeSelect.value=""!==s?s:"default";break;case"image":let a=t.querySelector(".img").getAttribute("width");this.widthInput.value=a;break;case"youtube":if(!1===t.classList.contains("btn")){let e=t.querySelector(".video").getAttribute("src");this.urlInput.value=e}else this.urlInput.value="";break;case"codepen":if(!1===t.classList.contains("btn")){let e=t.querySelector(".iframe"),s=e.getAttribute("src"),a=e.getAttribute("height");this.urlInput.value=s,this.heightInput.value=a}else this.urlInput.value="",this.heightInput.value="";break;case"list_o":let i=t.getAttribute("type");this.listTypeSelect.value=i;break;case"codeblock":let l=t.dataset.theme,o=t.dataset.lang,c=this.getClassName(n,"size");this.fontSizeSelect.value=""!==c?c:"default",this.themeSelect.value=l,this.languageSelect.value=o}switch(!0){case"HTMLAnchorElement"===a:let e=s.getAttribute("href");this.urlInput.value=e;break;case("HTMLTableCellElement"===a||"HTMLTableCaptionElement"===a)&&"table"===t.dataset.type:if("HTMLTableCellElement"===a){let e=parseInt(s.dataset.x)+1,a=t.querySelector("col:nth-child("+e+")").classList.value;this.colSizeSelect.value=this.getClassName(a,"size")}let n=this.getClassName(i,"color"),l=this.getClassName(i,"size");this.btnColorSelect.dataset.class=""!==n?n:"default",this.fontSizeSelect.value=""!==l?l:"default";break;case"HTMLSpanElement"===a||"HTMLElement"===a:let o=this.getClassName(i,"color");this.btnColorSelect.dataset.class=""!==o?o:"default";break;case"HTMLLIElement"===a:let c=this.getClassName(i,"color"),r=this.getClassName(i,"size");this.btnColorSelect.dataset.class=""!==c?c:"default",this.fontSizeSelect.value=""!==r?r:"default"}}}getClassName(e,t){if(this.classList.indexOf(t)>=0){let s=e.match(this.classReg[t]);return""!==e&&null!==s?s[0]:""}console.warn(`You send wrong type name : [${t}]`)}checkSameNode(){return this.focusNode===this.baseNode}wrapElement(e,t=null,s=null){let a=this.focusNode.textContent,n=this.findContenteditable(this.focusNode);n.innerHTML=n.innerHTML;let i,l,o,c,r=n.childNodes,d=r.length,u="";for(let e=0;e<d;e+=1)if("Text"===r[e].constructor.name&&a===r[e].textContent){i=e;break}switch(this.startTextCursor>this.endTextCursor?(l=this.endTextCursor,o=this.startTextCursor):(l=this.startTextCursor,o=this.endTextCursor),e){case"link":c=`${a.substring(0,l)}<a href="${t}" rel="nofollow">${a.substring(l,o)}</a>${a.substring(o)}`;break;case"bold":c=`${a.substring(0,l)}<b>${a.substring(l,o)}</b>${a.substring(o)}`;break;case"italic":c=`${a.substring(0,l)}<i>${a.substring(l,o)}</i>${a.substring(o)}`;break;case"underline":c=`${a.substring(0,l)}<u>${a.substring(l,o)}</u>${a.substring(o)}`;break;case"strike":c=`${a.substring(0,l)}<s>${a.substring(l,o)}</s>${a.substring(o)}`;break;case"wordblock":c=`${a.substring(0,l)}<code class="wordblock">${a.substring(l,o)}</code>${a.substring(o)}`;break;case"color":c=`${a.substring(0,l)}<span class="${s}">${a.substring(l,o)}</span>${a.substring(o)}`}for(let e=0;e<d;e+=1)e!==i?"Text"===r[e].constructor.name?u+=r[e].textContent:u+=r[e].outerHTML:u+=c;n.innerHTML=u}makeTextDecoration(e,t,s){if(this.focusNode===this.baseNode){let a=this.activeElement,n=a.constructor.name,i=this.findContenteditable(a);if(console.log(i,a),"HTMLAnchorElement"===n||"HTMLSpanElement"===n||"HTMLElement"===n){let n=a.classList,l=n.length,o=a.textContent;a.tagName===t?l>0?(a.insertAdjacentHTML("afterend",`<span class="${n.value}">${o}</span>`),this.activeElement=a.nextElementSibling,a.remove()):(a.insertAdjacentText("afterend",o),a.remove(),i.innerHTML=i.innerHTML,this.activeElement=this.wrap):"SPAN"===a.tagName?l>0?(a.insertAdjacentHTML("afterend",`<${e} class="${n.value}">${o}</${e}>`),this.activeElement=a.nextElementSibling,a.remove()):(a.insertAdjacentHTML("afterend",`<${e}>${o}</${e}>`),this.activeElement=a.nextElementSibling,a.remove()):!0===a.classList.contains(s)?a.classList.remove(s):a.classList.add(s)}else window.getSelection().focusOffset!==window.getSelection().baseOffset?this.wrapElement(s):!0===a.classList.contains(s)?a.classList.remove(s):a.classList.add(s)}else alert(this.messageWrongNode)}tableConstrol(e){let t=e.constructor.name,s=e.classList;if("HTMLButtonElement"===t){let e=document.querySelector(".lastset .item_table"),t=e.querySelector("colgroup"),a=e.querySelectorAll("col").length,n=e.querySelectorAll("tr"),i=e.querySelector("tbody");switch(!0){case s.contains("btn_col_add"):n.forEach((function(e){let t=e.querySelector("*:nth-child(1)").dataset.y;e.insertAdjacentHTML("beforeend",`<td contenteditable="true" data-x="${a}" data-y="${t}"></td>`)})),t.insertAdjacentHTML("beforeend",'<col class="size_100">');break;case s.contains("btn_col_del"):if(a>1){let e=t.querySelector("*:last-child");n.forEach((function(e){e.querySelector("*:last-child").remove()})),e.remove()}break;case s.contains("btn_row_add"):let e="<tr>";for(let t=0;t<a;t+=1)e+=`<td contenteditable="true" data-x="${t}" data-y="${n.length}"></td>`;e+="</tr>",i.insertAdjacentHTML("beforeend",e);break;case s.contains("btn_row_del"):n.length>1&&i.querySelector("tr:last-child").remove()}}}keybroadControl(e){let t=e.key,s=e.shiftKey,a="HTMLBodyElement"!==document.activeElement.constructor.name&&document.activeElement,n=this.findParent(a,"item");switch(!1!==a&&(this.activeElement=document.activeElement),!0){case"Enter"===t&&!1!==a:let i=a.tagName;if(!0!==s)if("LI"===i){if(e.preventDefault(),""===a.textContent){let e=n.querySelectorAll("li").length;this.addTextBlock(n),e>1&&a.remove()}else a.insertAdjacentHTML("afterend",this.HTMLChildList.replace("[content]","")),a.nextElementSibling.focus()}else e.preventDefault(),this.addTextBlock(n);break;case"Tab"===t&&!1!==a:if(!0===s)!0===a.classList.contains("title")&&e.preventDefault();else{this.contentArea.querySelector(".item:nth-last-child(1)")===n&&e.preventDefault()}}}saveAction(){}actionPrev(){}actionNext(){}dragStartEvent(e,t){t.insertAdjacentHTML("afterend",this.HTMLPositionBar)}dragOverEvent(e,t){let s=this.getElList(".position_bar"),a=this.findParent(e.target,"item");a=!1===a?this.findParent(e.target,"btn"):a,!1!==s&&s.forEach((function(e){e.remove()})),!1!==a&&a.insertAdjacentHTML("afterend",this.HTMLPositionBar),console.log("move")}dragEndEvent(e,t){let s=document.createEvent("HTMLEvents");s.initEvent("mouseup",!0,!0),s.eventName="mouseup";let a=this.getEl(".position_bar"),n=t.outerHTML;!1!==a&&(a.insertAdjacentHTML("afterend",n),a.remove(),t.remove()),t.removeAttribute("draggable"),this.contentArea.dispatchEvent(s)}ajax(e,t,s,a,n){let i=new FormData,l=new XMLHttpRequest;if("json"===a){for(let e in s)i.append(e,s[e]);s=i}l.open(e,t),l.onreadystatechange=function(){if(l.readyState==XMLHttpRequest.DONE&&200===l.status){let e=l.responseText,t=JSON.parse(e);n(t)}},l.send(s)}getJsonData(){let e=this.getElList(`${this.contentAreaName} > *`),t=[];return e.forEach(e=>{let s=e.dataset.type;switch(!0){case"title"===s:t.push({type:"title",class:[...e.classList],textContent:e.textContent});break;case"text"===s:t.push({type:"text",class:[...e.classList],textContent:e.innerHTML});break;case"image"===s:let a="PICTURE"===e.tagName,n=e.querySelector(".img"),i=n.getAttribute("src");t.push({type:"image",class:[...e.classList],hasWebp:a,size:n.getAttribute("width"),alt:n.getAttribute("alt"),src:i.replace(this.srcReg,"$1"),defaultFormat:i.replace(this.srcReg,"$2")});break;case"youtube"===s:let l=e.querySelector(".video");t.push({type:"youtube",class:[...e.classList],src:l.getAttribute("src"),allow:l.getAttribute("allow")});break;case"codepen"===s:let o=e.querySelector(".iframe");t.push({type:"codepen",class:[...e.classList],src:o.getAttribute("src"),height:o.getAttribute("height"),title:o.getAttribute("title")});break;case"list_u"===s||"list_o"===s:let c=e.querySelectorAll("li"),r=[];c.forEach((function(e){r.push({class:[...e.classList],textContent:e.textContent})})),t.push({type:"list",class:[...e.classList],tag:e.tagName.toLowerCase(),listType:e.getAttribute("type"),child:r});break;case"quote"===s:let d=e.querySelector(".text").textContent,u=e.querySelector(".author").textContent;t.push({type:"quote",class:[...e.classList],text:d,author:u});break;case"table"===s:let p=[],h=[],g=e.querySelector("caption").textContent,m=e.querySelectorAll("col"),b=e.querySelectorAll("tr");m.forEach((function(e){p.push(e.classList.value)})),b.forEach((function(e){let t=[],s=e.childElementCount,a=e.children;for(let e=0;e<s;e+=1)t.push({tag:a[e].tagName.toLowerCase(),class:[...a[e].classList],textContent:a[e].textContent});h.push(t)})),t.push({type:"table",class:[...e.classList],caption:g,colgroup:p,child:h});break;case"codeblock"===s:let f=e.dataset.theme,L=e.dataset.lang,v=e.querySelector("code");t.push({type:"codeblock",class:[...e.classList],theme:f,lang:L,code:{class:[...v.classList],innerHTML:v.innerHTML}});break;case"link_box"===s:let k=e.querySelector(".link_box").getAttribute("href"),y=e.querySelector(".img").getAttribute("src"),E=e.querySelector(".link_title").textContent,x=e.querySelector(".link_description").textContent,w=e.querySelector(".link_domain").textContent;t.push({type:"link_box",class:[...e.classList],url:k,imgSrc:y,title:E,description:x,domain:w});break;case"btn"===s:let T,C=e.querySelector(".icon"),S=C.tagName.toLowerCase();T="svg"===S?C.querySelector("use").getAttribute("href"):C.getAttribute("src"),t.push({type:"btn",value:e.dataset.value,textContent:e.textContent,icon:{type:S,viewBox:C.getAttribute("viewBox"),class:[...C.classList],url:T}});break;default:t.push({other:e.outerHTML})}}),this.contentData[this.langStatus]=t,this.contentData}setContent(e){let t="";e.forEach((function(e){switch(e.type){case"title":t+=`<h1 class="${e.class.join(" ")}" contenteditable="true" data-type="${e.type}">${e.textContent}</h1>`;break;case"text":t+=`<p class="${e.class.join(" ")}" contenteditable="true" data-type="${e.type}">${e.textContent}</p>`;break;case"image":!0===e.useWebp?(t+=`<picture class="${e.class.join(" ")}" data-type="${e.type}">`,!0===e.hasWebp&&(t+=`<source srcset="${e.src}.webp" type="image/webp">`),t+=`<img src="${e.src}.${e.defaultFormat}" width="${e.size}" alt="${e.alt}" class="img"></picture>`):t+=`<div class="${e.class.join(" ")}" data-type="image"><img src="${e.src}.${e.defaultFormat}" width="${e.size}" alt="${e.alt}" class="img"></div>`;break;case"btn":"image"===e.value?(t+=`<div class="btn" data-type="${e.type}" data-value="${e.value}">`,"svg"===e.icon.type?t+=`<svg viewBox="${e.icon.viewBox}" class="${e.icon.class.join(" ")}"><use class="path" xlink:href="${e.icon.url}" href="${e.icon.url}"></use></svg>`:t+=`<img src="${e.icon.url}" alt="image icon" class="">`,t+=`${e.textContent.replace(/\n/i,"").replace(/^\s*/i,"").replace(/\s*$/i,"")}</div>`):"youtube"===e.value?(t+=`<div class="btn" data-type="${e.type}" data-value="${e.value}">`,"svg"===e.icon.type?t+=`<svg viewBox="${e.icon.viewBox}" class="${e.icon.class.join(" ")}"><use class="path" xlink:href="${e.icon.url}" href="${e.icon.url}"></use></svg>`:t+=`<img src="${e.icon.url}" alt="youtube icon" class="">`,t+=`${e.textContent.replace(/\n/i,"").replace(/^\s*/i,"").replace(/\s*$/i,"")}</div>`):"codepen"===e.value&&(t+=`<div class="btn" data-type="${e.type}" data-value="${e.value}">`,"svg"===e.icon.type?t+=`<svg viewBox="${e.icon.viewBox}" class="${e.icon.class.join(" ")}"><use class="path" xlink:href="${e.icon.url}" href="${e.icon.url}"></use></svg>`:t+=`<img src="${e.icon.url}" alt="codepen icon" class="">`,t+=`${e.textContent.replace(/\n/i,"").replace(/^\s*/i,"").replace(/\s*$/i,"")}</div>`);break;case"youtube":t+=`<div class="${e.class.join(" ")}" data-type="${e.type}"><iframe src="${e.src}" allow="${e.allow}" allowfullscreen="" class="video"></iframe></div>`;break;case"codepen":t+=`<div class="${e.class.join(" ")}" data-type="${e.type}"><iframe height="${e.height}" title="" src="${e.src}" allowfullscreen="" class="iframe"></iframe></div>`;break;case"list":t+=`<${e.tag} class="${e.class.join(" ")}" data-type="${e.type}">`,e.child.forEach((function(e){e.class.length>0?t+=`<li class="${e.class.join(" ")}" contenteditable="true">${e.textContent}</li>`:t+=`<li contenteditable="true">${e.textContent}</li>`})),t+=`</${e.tag}>`;break;case"quote":t+=`<blockquote class="${e.class.join(" ")}" data-type="${e.type}"><p class="text" contenteditable="true">${e.text}</p><p class="author" contenteditable="true">${e.author}</p></blockquote>`;break;case"table":let s=0;t+=`<div class="${e.class.join(" ")}" data-type="${e.type}"><div class="scroll"><table class="item_table"><caption contenteditable="true">${e.caption}</caption><colgroup>`,e.colgroup.forEach((function(e){t+=`<col class="${e}">`})),t+="</colgroup><tbody>",e.child.forEach((function(e){let a=0;t+="<tr>",e.forEach((function(e){e.class.length>0?t+=`<${e.tag} class="${e.class.join(" ")}" contenteditable="true" data-x="${a}" data-y="${s}"></${e.tag}>`:t+=`<${e.tag} contenteditable="true" data-x="${a}" data-y="${s}"></${e.tag}>`,a+=1})),t+="</tr>",s+=1})),t+='</tbody></table></div><button class="btn btn_col_add">Add col</button><button class="btn btn_col_del">Remove col</button><button class="btn btn_row_add">Add row</button><button class="btn btn_row_del">Remove row</button></div>';break;case"codeblock":t+=`<pre class="${e.class.join(" ")}" data-type="${e.type}" data-theme="${e.theme}" data-lang="${e.lang}"><code class="${e.code.class.join(" ")}" contenteditable="true">${e.code.innerHTML}</code></pre>`;break;case"link_box":t+=`<div class="${e.class.join()}" data-type="${e.type}"><a href="${e.url}" target="_blank" class="link_box clearfix" draggable="false"><div class="img_area"><img src=""${e.imgSrc} alt="미리보기 이미지" class="img" draggable="false"></div><div class="text_area"><p class="link_title ellipsis">${e.title}</p><p class="link_description ellipsis">${e.description}</p><p class="link_domain">${e.domain}</p></div></a></div>`;break;default:t+=e.other}})),this.contentArea.innerHTML=t}addkustomContent(e){let t=!1===this.getEl(".lastset")?this.getEl(`${this.contentAreaName} > *:nth-last-child(1)`):this.getEl(".lastset");t.insertAdjacentHTML("afterend",e),t.nextElementSibling.classList.add("lastset"),t.classList.remove("lastset")}}}])}));